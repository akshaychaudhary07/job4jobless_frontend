"use strict";(self.webpackChunkjobforjobax=self.webpackChunkjobforjobax||[]).push([[252],{2917:vr=>{const k={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};k.localCName=k.generateIdentifier(),k.splitLines=function(m){return m.trim().split("\n").map(y=>y.trim())},k.splitSections=function(m){return m.split("\nm=").map((S,A)=>(A>0?"m="+S:S).trim()+"\r\n")},k.getDescription=function(m){const y=k.splitSections(m);return y&&y[0]},k.getMediaSections=function(m){const y=k.splitSections(m);return y.shift(),y},k.matchPrefix=function(m,y){return k.splitLines(m).filter(S=>0===S.indexOf(y))},k.parseCandidate=function(m){let y;y=0===m.indexOf("a=candidate:")?m.substring(12).split(" "):m.substring(10).split(" ");const S={foundation:y[0],component:{1:"rtp",2:"rtcp"}[y[1]]||y[1],protocol:y[2].toLowerCase(),priority:parseInt(y[3],10),ip:y[4],address:y[4],port:parseInt(y[5],10),type:y[7]};for(let A=8;A<y.length;A+=2)switch(y[A]){case"raddr":S.relatedAddress=y[A+1];break;case"rport":S.relatedPort=parseInt(y[A+1],10);break;case"tcptype":S.tcpType=y[A+1];break;case"ufrag":S.ufrag=y[A+1],S.usernameFragment=y[A+1];break;default:void 0===S[y[A]]&&(S[y[A]]=y[A+1])}return S},k.writeCandidate=function(m){const y=[];y.push(m.foundation);const S=m.component;y.push("rtp"===S?1:"rtcp"===S?2:S),y.push(m.protocol.toUpperCase()),y.push(m.priority),y.push(m.address||m.ip),y.push(m.port);const A=m.type;return y.push("typ"),y.push(A),"host"!==A&&m.relatedAddress&&m.relatedPort&&(y.push("raddr"),y.push(m.relatedAddress),y.push("rport"),y.push(m.relatedPort)),m.tcpType&&"tcp"===m.protocol.toLowerCase()&&(y.push("tcptype"),y.push(m.tcpType)),(m.usernameFragment||m.ufrag)&&(y.push("ufrag"),y.push(m.usernameFragment||m.ufrag)),"candidate:"+y.join(" ")},k.parseIceOptions=function(m){return m.substring(14).split(" ")},k.parseRtpMap=function(m){let y=m.substring(9).split(" ");const S={payloadType:parseInt(y.shift(),10)};return y=y[0].split("/"),S.name=y[0],S.clockRate=parseInt(y[1],10),S.channels=3===y.length?parseInt(y[2],10):1,S.numChannels=S.channels,S},k.writeRtpMap=function(m){let y=m.payloadType;void 0!==m.preferredPayloadType&&(y=m.preferredPayloadType);const S=m.channels||m.numChannels||1;return"a=rtpmap:"+y+" "+m.name+"/"+m.clockRate+(1!==S?"/"+S:"")+"\r\n"},k.parseExtmap=function(m){const y=m.substring(9).split(" ");return{id:parseInt(y[0],10),direction:y[0].indexOf("/")>0?y[0].split("/")[1]:"sendrecv",uri:y[1],attributes:y.slice(2).join(" ")}},k.writeExtmap=function(m){return"a=extmap:"+(m.id||m.preferredId)+(m.direction&&"sendrecv"!==m.direction?"/"+m.direction:"")+" "+m.uri+(m.attributes?" "+m.attributes:"")+"\r\n"},k.parseFmtp=function(m){const y={};let S;const A=m.substring(m.indexOf(" ")+1).split(";");for(let j=0;j<A.length;j++)S=A[j].trim().split("="),y[S[0].trim()]=S[1];return y},k.writeFmtp=function(m){let y="",S=m.payloadType;if(void 0!==m.preferredPayloadType&&(S=m.preferredPayloadType),m.parameters&&Object.keys(m.parameters).length){const A=[];Object.keys(m.parameters).forEach(j=>{A.push(void 0!==m.parameters[j]?j+"="+m.parameters[j]:j)}),y+="a=fmtp:"+S+" "+A.join(";")+"\r\n"}return y},k.parseRtcpFb=function(m){const y=m.substring(m.indexOf(" ")+1).split(" ");return{type:y.shift(),parameter:y.join(" ")}},k.writeRtcpFb=function(m){let y="",S=m.payloadType;return void 0!==m.preferredPayloadType&&(S=m.preferredPayloadType),m.rtcpFeedback&&m.rtcpFeedback.length&&m.rtcpFeedback.forEach(A=>{y+="a=rtcp-fb:"+S+" "+A.type+(A.parameter&&A.parameter.length?" "+A.parameter:"")+"\r\n"}),y},k.parseSsrcMedia=function(m){const y=m.indexOf(" "),S={ssrc:parseInt(m.substring(7,y),10)},A=m.indexOf(":",y);return A>-1?(S.attribute=m.substring(y+1,A),S.value=m.substring(A+1)):S.attribute=m.substring(y+1),S},k.parseSsrcGroup=function(m){const y=m.substring(13).split(" ");return{semantics:y.shift(),ssrcs:y.map(S=>parseInt(S,10))}},k.getMid=function(m){const y=k.matchPrefix(m,"a=mid:")[0];if(y)return y.substring(6)},k.parseFingerprint=function(m){const y=m.substring(14).split(" ");return{algorithm:y[0].toLowerCase(),value:y[1].toUpperCase()}},k.getDtlsParameters=function(m,y){return{role:"auto",fingerprints:k.matchPrefix(m+y,"a=fingerprint:").map(k.parseFingerprint)}},k.writeDtlsParameters=function(m,y){let S="a=setup:"+y+"\r\n";return m.fingerprints.forEach(A=>{S+="a=fingerprint:"+A.algorithm+" "+A.value+"\r\n"}),S},k.parseCryptoLine=function(m){const y=m.substring(9).split(" ");return{tag:parseInt(y[0],10),cryptoSuite:y[1],keyParams:y[2],sessionParams:y.slice(3)}},k.writeCryptoLine=function(m){return"a=crypto:"+m.tag+" "+m.cryptoSuite+" "+("object"==typeof m.keyParams?k.writeCryptoKeyParams(m.keyParams):m.keyParams)+(m.sessionParams?" "+m.sessionParams.join(" "):"")+"\r\n"},k.parseCryptoKeyParams=function(m){if(0!==m.indexOf("inline:"))return null;const y=m.substring(7).split("|");return{keyMethod:"inline",keySalt:y[0],lifeTime:y[1],mkiValue:y[2]?y[2].split(":")[0]:void 0,mkiLength:y[2]?y[2].split(":")[1]:void 0}},k.writeCryptoKeyParams=function(m){return m.keyMethod+":"+m.keySalt+(m.lifeTime?"|"+m.lifeTime:"")+(m.mkiValue&&m.mkiLength?"|"+m.mkiValue+":"+m.mkiLength:"")},k.getCryptoParameters=function(m,y){return k.matchPrefix(m+y,"a=crypto:").map(k.parseCryptoLine)},k.getIceParameters=function(m,y){const S=k.matchPrefix(m+y,"a=ice-ufrag:")[0],A=k.matchPrefix(m+y,"a=ice-pwd:")[0];return S&&A?{usernameFragment:S.substring(12),password:A.substring(10)}:null},k.writeIceParameters=function(m){let y="a=ice-ufrag:"+m.usernameFragment+"\r\na=ice-pwd:"+m.password+"\r\n";return m.iceLite&&(y+="a=ice-lite\r\n"),y},k.parseRtpParameters=function(m){const y={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},A=k.splitLines(m)[0].split(" ");y.profile=A[2];for(let H=3;H<A.length;H++){const ee=A[H],de=k.matchPrefix(m,"a=rtpmap:"+ee+" ")[0];if(de){const ie=k.parseRtpMap(de),ue=k.matchPrefix(m,"a=fmtp:"+ee+" ");switch(ie.parameters=ue.length?k.parseFmtp(ue[0]):{},ie.rtcpFeedback=k.matchPrefix(m,"a=rtcp-fb:"+ee+" ").map(k.parseRtcpFb),y.codecs.push(ie),ie.name.toUpperCase()){case"RED":case"ULPFEC":y.fecMechanisms.push(ie.name.toUpperCase())}}}k.matchPrefix(m,"a=extmap:").forEach(H=>{y.headerExtensions.push(k.parseExtmap(H))});const j=k.matchPrefix(m,"a=rtcp-fb:* ").map(k.parseRtcpFb);return y.codecs.forEach(H=>{j.forEach(ee=>{H.rtcpFeedback.find(ie=>ie.type===ee.type&&ie.parameter===ee.parameter)||H.rtcpFeedback.push(ee)})}),y},k.writeRtpDescription=function(m,y){let S="";S+="m="+m+" ",S+=y.codecs.length>0?"9":"0",S+=" "+(y.profile||"UDP/TLS/RTP/SAVPF")+" ",S+=y.codecs.map(j=>void 0!==j.preferredPayloadType?j.preferredPayloadType:j.payloadType).join(" ")+"\r\n",S+="c=IN IP4 0.0.0.0\r\n",S+="a=rtcp:9 IN IP4 0.0.0.0\r\n",y.codecs.forEach(j=>{S+=k.writeRtpMap(j),S+=k.writeFmtp(j),S+=k.writeRtcpFb(j)});let A=0;return y.codecs.forEach(j=>{j.maxptime>A&&(A=j.maxptime)}),A>0&&(S+="a=maxptime:"+A+"\r\n"),y.headerExtensions&&y.headerExtensions.forEach(j=>{S+=k.writeExtmap(j)}),S},k.parseRtpEncodingParameters=function(m){const y=[],S=k.parseRtpParameters(m),A=-1!==S.fecMechanisms.indexOf("RED"),j=-1!==S.fecMechanisms.indexOf("ULPFEC"),H=k.matchPrefix(m,"a=ssrc:").map(pe=>k.parseSsrcMedia(pe)).filter(pe=>"cname"===pe.attribute),ee=H.length>0&&H[0].ssrc;let de;const ie=k.matchPrefix(m,"a=ssrc-group:FID").map(pe=>pe.substring(17).split(" ").map(it=>parseInt(it,10)));ie.length>0&&ie[0].length>1&&ie[0][0]===ee&&(de=ie[0][1]),S.codecs.forEach(pe=>{if("RTX"===pe.name.toUpperCase()&&pe.parameters.apt){let be={ssrc:ee,codecPayloadType:parseInt(pe.parameters.apt,10)};ee&&de&&(be.rtx={ssrc:de}),y.push(be),A&&(be=JSON.parse(JSON.stringify(be)),be.fec={ssrc:ee,mechanism:j?"red+ulpfec":"red"},y.push(be))}}),0===y.length&&ee&&y.push({ssrc:ee});let ue=k.matchPrefix(m,"b=");return ue.length&&(ue=0===ue[0].indexOf("b=TIAS:")?parseInt(ue[0].substring(7),10):0===ue[0].indexOf("b=AS:")?1e3*parseInt(ue[0].substring(5),10)*.95-16e3:void 0,y.forEach(pe=>{pe.maxBitrate=ue})),y},k.parseRtcpParameters=function(m){const y={},S=k.matchPrefix(m,"a=ssrc:").map(H=>k.parseSsrcMedia(H)).filter(H=>"cname"===H.attribute)[0];S&&(y.cname=S.value,y.ssrc=S.ssrc);const A=k.matchPrefix(m,"a=rtcp-rsize");y.reducedSize=A.length>0,y.compound=0===A.length;const j=k.matchPrefix(m,"a=rtcp-mux");return y.mux=j.length>0,y},k.writeRtcpParameters=function(m){let y="";return m.reducedSize&&(y+="a=rtcp-rsize\r\n"),m.mux&&(y+="a=rtcp-mux\r\n"),void 0!==m.ssrc&&m.cname&&(y+="a=ssrc:"+m.ssrc+" cname:"+m.cname+"\r\n"),y},k.parseMsid=function(m){let y;const S=k.matchPrefix(m,"a=msid:");if(1===S.length)return y=S[0].substring(7).split(" "),{stream:y[0],track:y[1]};const A=k.matchPrefix(m,"a=ssrc:").map(j=>k.parseSsrcMedia(j)).filter(j=>"msid"===j.attribute);return A.length>0?(y=A[0].value.split(" "),{stream:y[0],track:y[1]}):void 0},k.parseSctpDescription=function(m){const y=k.parseMLine(m),S=k.matchPrefix(m,"a=max-message-size:");let A;S.length>0&&(A=parseInt(S[0].substring(19),10)),isNaN(A)&&(A=65536);const j=k.matchPrefix(m,"a=sctp-port:");if(j.length>0)return{port:parseInt(j[0].substring(12),10),protocol:y.fmt,maxMessageSize:A};const H=k.matchPrefix(m,"a=sctpmap:");if(H.length>0){const ee=H[0].substring(10).split(" ");return{port:parseInt(ee[0],10),protocol:ee[1],maxMessageSize:A}}},k.writeSctpDescription=function(m,y){let S=[];return S="DTLS/SCTP"!==m.protocol?["m="+m.kind+" 9 "+m.protocol+" "+y.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+y.port+"\r\n"]:["m="+m.kind+" 9 "+m.protocol+" "+y.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+y.port+" "+y.protocol+" 65535\r\n"],void 0!==y.maxMessageSize&&S.push("a=max-message-size:"+y.maxMessageSize+"\r\n"),S.join("")},k.generateSessionId=function(){return Math.random().toString().substr(2,22)},k.writeSessionBoilerplate=function(m,y,S){let A;const j=void 0!==y?y:2;return A=m||k.generateSessionId(),"v=0\r\no="+(S||"thisisadapterortc")+" "+A+" "+j+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},k.getDirection=function(m,y){const S=k.splitLines(m);for(let A=0;A<S.length;A++)switch(S[A]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return S[A].substring(2)}return y?k.getDirection(y):"sendrecv"},k.getKind=function(m){return k.splitLines(m)[0].split(" ")[0].substring(2)},k.isRejected=function(m){return"0"===m.split(" ",2)[1]},k.parseMLine=function(m){const S=k.splitLines(m)[0].substring(2).split(" ");return{kind:S[0],port:parseInt(S[1],10),protocol:S[2],fmt:S.slice(3).join(" ")}},k.parseOLine=function(m){const S=k.matchPrefix(m,"o=")[0].substring(2).split(" ");return{username:S[0],sessionId:S[1],sessionVersion:parseInt(S[2],10),netType:S[3],addressType:S[4],address:S[5]}},k.isValidSDP=function(m){if("string"!=typeof m||0===m.length)return!1;const y=k.splitLines(m);for(let S=0;S<y.length;S++)if(y[S].length<2||"="!==y[S].charAt(1))return!1;return!0},vr.exports=k},8222:(vr,k,m)=>{m.d(k,{ZP:()=>di});var y={};m.r(y),m.d(y,{fixNegotiationNeeded:()=>Zt,shimAddTrackRemoveTrack:()=>Xt,shimAddTrackRemoveTrackWithNative:()=>Ge,shimGetDisplayMedia:()=>re,shimGetSendersWithDtmf:()=>Ct,shimGetStats:()=>Wt,shimGetUserMedia:()=>xt,shimMediaStream:()=>Ht,shimOnTrack:()=>ye,shimPeerConnection:()=>vt,shimSenderReceiverGetStats:()=>Yt});var S={};m.r(S),m.d(S,{shimAddTransceiver:()=>ke,shimCreateAnswer:()=>Er,shimCreateOffer:()=>Et,shimGetDisplayMedia:()=>Rr,shimGetParameters:()=>Rt,shimGetUserMedia:()=>Qt,shimOnTrack:()=>er,shimPeerConnection:()=>Ke,shimRTCDataChannel:()=>Tt,shimReceiverGetStats:()=>Je,shimRemoveStream:()=>kt,shimSenderGetStats:()=>St});var A={};m.r(A),m.d(A,{shimAudioContext:()=>qe,shimCallbacksAPI:()=>tr,shimConstraints:()=>Pr,shimCreateOfferLegacy:()=>ir,shimGetUserMedia:()=>Ot,shimLocalStreamsAPI:()=>Pt,shimRTCIceServerUrls:()=>rr,shimRemoteStreamsAPI:()=>At,shimTrackEventTransceiver:()=>nr});var j={};m.r(j),m.d(j,{removeExtmapAllowMixed:()=>wt,shimAddIceCandidateNullOrEmpty:()=>ct,shimConnectionState:()=>Dt,shimMaxMessageSize:()=>at,shimParameterlessSetLocalDescription:()=>ft,shimRTCIceCandidate:()=>De,shimRTCIceCandidateRelayProtocol:()=>He,shimSendThrowTypeError:()=>We});var H=m(5861);function ee(t,e){this.v=t,this.k=e}function de(t){var e,n;function r(a,l){try{var u=t[a](l),p=u.value,h=p instanceof ee;Promise.resolve(h?p.v:p).then(function(b){if(h){var v="return"===a?"return":"next";if(!p.k||b.done)return r(v,b);b=t[v](b).value}i(u.done?"return":"normal",b)},function(b){r("throw",b)})}catch(b){i("throw",b)}}function i(a,l){switch(a){case"return":e.resolve({value:l,done:!0});break;case"throw":e.reject(l);break;default:e.resolve({value:l,done:!1})}(e=e.next)?r(e.key,e.arg):n=null}this._invoke=function(a,l){return new Promise(function(u,p){var h={key:a,arg:l,resolve:u,reject:p,next:null};n?n=n.next=h:(e=n=h,r(a,l))})},"function"!=typeof t.return&&(this.return=void 0)}de.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},de.prototype.next=function(t){return this._invoke("next",t)},de.prototype.throw=function(t){return this._invoke("throw",t)},de.prototype.return=function(t){return this._invoke("return",t)};class ue{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(e){this.flush(),this._parts.push(e)}append(e){this._pieces.push(e)}flush(){if(this._pieces.length>0){const e=new Uint8Array(this._pieces);this._parts.push(e),this._pieces=[]}}toArrayBuffer(){const e=[];for(const n of this._parts)e.push(n);return function pe(t){let e=0;for(const i of t)e+=i.byteLength;const n=new Uint8Array(e);let r=0;for(const i of t){const a=new Uint8Array(i.buffer,i.byteOffset,i.byteLength);n.set(a,r),r+=i.byteLength}return n}(e).buffer}}function be(t){return new $e(t).unpack()}function it(t){const e=new ze;return e.pack(t),e.getBuffer()}class $e{constructor(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const e=this.unpack_uint8();if(e<128)return e;if((224^e)<32)return(224^e)-32;let n;if((n=160^e)<=15)return this.unpack_raw(n);if((n=176^e)<=15)return this.unpack_string(n);if((n=144^e)<=15)return this.unpack_array(n);if((n=128^e)<=15)return this.unpack_map(n);switch(e){case 192:return null;case 193:case 212:case 213:case 214:case 215:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 216:return n=this.unpack_uint16(),this.unpack_string(n);case 217:return n=this.unpack_uint32(),this.unpack_string(n);case 218:return n=this.unpack_uint16(),this.unpack_raw(n);case 219:return n=this.unpack_uint32(),this.unpack_raw(n);case 220:return n=this.unpack_uint16(),this.unpack_array(n);case 221:return n=this.unpack_uint32(),this.unpack_array(n);case 222:return n=this.unpack_uint16(),this.unpack_map(n);case 223:return n=this.unpack_uint32(),this.unpack_map(n)}}unpack_uint8(){const e=255&this.dataView[this.index];return this.index++,e}unpack_uint16(){const e=this.read(2),n=256*(255&e[0])+(255&e[1]);return this.index+=2,n}unpack_uint32(){const e=this.read(4),n=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,n}unpack_uint64(){const e=this.read(8),n=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,n}unpack_int8(){const e=this.unpack_uint8();return e<128?e:e-256}unpack_int16(){const e=this.unpack_uint16();return e<32768?e:e-65536}unpack_int32(){const e=this.unpack_uint32();return e<2**31?e:e-2**32}unpack_int64(){const e=this.unpack_uint64();return e<2**63?e:e-2**64}unpack_raw(e){if(this.length<this.index+e)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${e} ${this.length}`);const n=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,n}unpack_string(e){const n=this.read(e);let a,l,r=0,i="";for(;r<e;)a=n[r],a<160?(l=a,r++):(192^a)<32?(l=(31&a)<<6|63&n[r+1],r+=2):(224^a)<16?(l=(15&a)<<12|(63&n[r+1])<<6|63&n[r+2],r+=3):(l=(7&a)<<18|(63&n[r+1])<<12|(63&n[r+2])<<6|63&n[r+3],r+=4),i+=String.fromCodePoint(l);return this.index+=e,i}unpack_array(e){const n=new Array(e);for(let r=0;r<e;r++)n[r]=this.unpack();return n}unpack_map(e){const n={};for(let r=0;r<e;r++)n[this.unpack()]=this.unpack();return n}unpack_float(){const e=this.unpack_uint32();return(0==e>>31?1:-1)*(8388607&e|8388608)*2**((e>>23&255)-127-23)}unpack_double(){const e=this.unpack_uint32(),i=(e>>20&2047)-1023;return(0==e>>31?1:-1)*((1048575&e|1048576)*2**(i-20)+this.unpack_uint32()*2**(i-52))}read(e){const n=this.index;if(n+e<=this.length)return this.dataView.subarray(n,n+e);throw new Error("BinaryPackFailure: read index out of range")}}class ze{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(e){if("string"==typeof e)this.pack_string(e);else if("number"==typeof e)Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if("boolean"==typeof e)!0===e?this._bufferBuilder.append(195):!1===e&&this._bufferBuilder.append(194);else if(void 0===e)this._bufferBuilder.append(192);else{if("object"!=typeof e)throw new Error(`Type "${typeof e}" not yet supported`);if(null===e)this._bufferBuilder.append(192);else{const n=e.constructor;if(e instanceof Array)this.pack_array(e);else if(e instanceof ArrayBuffer)this.pack_bin(new Uint8Array(e));else if("BYTES_PER_ELEMENT"in e)this.pack_bin(new Uint8Array(e.buffer,e.byteOffset,e.byteLength));else if(e instanceof Date)this.pack_string(e.toString());else{if(n!=Object&&!n.toString().startsWith("class"))throw new Error(`Type "${n.toString()}" not yet supported`);this.pack_object(e)}}}this._bufferBuilder.flush()}pack_bin(e){const n=e.length;if(n<=15)this.pack_uint8(160+n);else if(n<=65535)this._bufferBuilder.append(218),this.pack_uint16(n);else{if(!(n<=4294967295))throw new Error("Invalid length");this._bufferBuilder.append(219),this.pack_uint32(n)}this._bufferBuilder.append_buffer(e)}pack_string(e){const n=this._textEncoder.encode(e),r=n.length;if(r<=15)this.pack_uint8(176+r);else if(r<=65535)this._bufferBuilder.append(216),this.pack_uint16(r);else{if(!(r<=4294967295))throw new Error("Invalid length");this._bufferBuilder.append(217),this.pack_uint32(r)}this._bufferBuilder.append_buffer(n)}pack_array(e){const n=e.length;if(n<=15)this.pack_uint8(144+n);else if(n<=65535)this._bufferBuilder.append(220),this.pack_uint16(n);else{if(!(n<=4294967295))throw new Error("Invalid length");this._bufferBuilder.append(221),this.pack_uint32(n)}for(let r=0;r<n;r++)this.pack(e[r])}pack_integer(e){if(e>=-32&&e<=127)this._bufferBuilder.append(255&e);else if(e>=0&&e<=255)this._bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this._bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this._bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this._bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this._bufferBuilder.append(210),this.pack_int32(e);else if(e>=-0x8000000000000000&&e<=0x8000000000000000)this._bufferBuilder.append(211),this.pack_int64(e);else{if(!(e>=0&&e<=0x10000000000000000))throw new Error("Invalid integer");this._bufferBuilder.append(207),this.pack_uint64(e)}}pack_double(e){let n=0;e<0&&(n=1,e=-e);const r=Math.floor(Math.log(e)/Math.LN2),a=Math.floor((e/2**r-1)*2**52),l=2**32,u=n<<31|r+1023<<20|a/l&1048575,p=a%l;this._bufferBuilder.append(203),this.pack_int32(u),this.pack_int32(p)}pack_object(e){const r=Object.keys(e).length;if(r<=15)this.pack_uint8(128+r);else if(r<=65535)this._bufferBuilder.append(222),this.pack_uint16(r);else{if(!(r<=4294967295))throw new Error("Invalid length");this._bufferBuilder.append(223),this.pack_uint32(r)}for(const i in e)e.hasOwnProperty(i)&&(this.pack(i),this.pack(e[i]))}pack_uint8(e){this._bufferBuilder.append(e)}pack_uint16(e){this._bufferBuilder.append(e>>8),this._bufferBuilder.append(255&e)}pack_uint32(e){const n=4294967295&e;this._bufferBuilder.append((4278190080&n)>>>24),this._bufferBuilder.append((16711680&n)>>>16),this._bufferBuilder.append((65280&n)>>>8),this._bufferBuilder.append(255&n)}pack_uint64(e){const n=e/4294967296,r=e%2**32;this._bufferBuilder.append((4278190080&n)>>>24),this._bufferBuilder.append((16711680&n)>>>16),this._bufferBuilder.append((65280&n)>>>8),this._bufferBuilder.append(255&n),this._bufferBuilder.append((4278190080&r)>>>24),this._bufferBuilder.append((16711680&r)>>>16),this._bufferBuilder.append((65280&r)>>>8),this._bufferBuilder.append(255&r)}pack_int8(e){this._bufferBuilder.append(255&e)}pack_int16(e){this._bufferBuilder.append((65280&e)>>8),this._bufferBuilder.append(255&e)}pack_int32(e){this._bufferBuilder.append(e>>>24&255),this._bufferBuilder.append((16711680&e)>>>16),this._bufferBuilder.append((65280&e)>>>8),this._bufferBuilder.append(255&e)}pack_int64(e){const n=Math.floor(e/4294967296),r=e%2**32;this._bufferBuilder.append((4278190080&n)>>>24),this._bufferBuilder.append((16711680&n)>>>16),this._bufferBuilder.append((65280&n)>>>8),this._bufferBuilder.append(255&n),this._bufferBuilder.append((4278190080&r)>>>24),this._bufferBuilder.append((16711680&r)>>>16),this._bufferBuilder.append((65280&r)>>>8),this._bufferBuilder.append(255&r)}constructor(){this._bufferBuilder=new ue,this._textEncoder=new TextEncoder}}let Sr=!0,Gt=!0;function st(t,e,n){const r=t.match(e);return r&&r.length>=n&&parseInt(r[n],10)}function Se(t,e,n){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(l,u){if(l!==e)return i.apply(this,arguments);const p=h=>{const b=n(h);b&&(u.handleEvent?u.handleEvent(b):u(b))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(u,p),i.apply(this,[l,p])};const a=r.removeEventListener;r.removeEventListener=function(l,u){if(l!==e||!this._eventMap||!this._eventMap[e])return a.apply(this,arguments);if(!this._eventMap[e].has(u))return a.apply(this,arguments);const p=this._eventMap[e].get(u);return this._eventMap[e].delete(u),0===this._eventMap[e].size&&delete this._eventMap[e],0===Object.keys(this._eventMap).length&&delete this._eventMap,a.apply(this,[l,p])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(l){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),l&&this.addEventListener(e,this["_on"+e]=l)},enumerable:!0,configurable:!0})}function kr(t){return"boolean"!=typeof t?new Error("Argument type: "+typeof t+". Please use a boolean."):(Sr=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function Kt(t){return"boolean"!=typeof t?new Error("Argument type: "+typeof t+". Please use a boolean."):(Gt=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function bt(){if("object"==typeof window){if(Sr)return;typeof console<"u"&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function _t(t,e){Gt&&console.warn(t+" is deprecated, please use "+e+" instead.")}function Jt(t){return"[object Object]"===Object.prototype.toString.call(t)}function ot(t){return Jt(t)?Object.keys(t).reduce(function(e,n){const r=Jt(t[n]),i=r?ot(t[n]):t[n],a=r&&!Object.keys(i).length;return void 0===i||a?e:Object.assign(e,{[n]:i})},{}):t}function Ue(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?Ue(t,t.get(e[r]),n):r.endsWith("Ids")&&e[r].forEach(i=>{Ue(t,t.get(i),n)})}))}function Ve(t,e,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===e)return i;const a=[];return t.forEach(l=>{"track"===l.type&&l.trackIdentifier===e.id&&a.push(l)}),a.forEach(l=>{t.forEach(u=>{u.type===r&&u.trackId===l.id&&Ue(t,u,i)})}),i}const qt=bt;function xt(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const r=function(u){if("object"!=typeof u||u.mandatory||u.optional)return u;const p={};return Object.keys(u).forEach(h=>{if("require"===h||"advanced"===h||"mediaSource"===h)return;const b="object"==typeof u[h]?u[h]:{ideal:u[h]};void 0!==b.exact&&"number"==typeof b.exact&&(b.min=b.max=b.exact);const v=function(O,L){return O?O+L.charAt(0).toUpperCase()+L.slice(1):"deviceId"===L?"sourceId":L};if(void 0!==b.ideal){p.optional=p.optional||[];let O={};"number"==typeof b.ideal?(O[v("min",h)]=b.ideal,p.optional.push(O),O={},O[v("max",h)]=b.ideal,p.optional.push(O)):(O[v("",h)]=b.ideal,p.optional.push(O))}void 0!==b.exact&&"number"!=typeof b.exact?(p.mandatory=p.mandatory||{},p.mandatory[v("",h)]=b.exact):["min","max"].forEach(O=>{void 0!==b[O]&&(p.mandatory=p.mandatory||{},p.mandatory[v(O,h)]=b[O])})}),u.advanced&&(p.optional=(p.optional||[]).concat(u.advanced)),p},i=function(u,p){if(e.version>=61)return p(u);if((u=JSON.parse(JSON.stringify(u)))&&"object"==typeof u.audio){const h=function(b,v,O){v in b&&!(O in b)&&(b[O]=b[v],delete b[v])};h((u=JSON.parse(JSON.stringify(u))).audio,"autoGainControl","googAutoGainControl"),h(u.audio,"noiseSuppression","googNoiseSuppression"),u.audio=r(u.audio)}if(u&&"object"==typeof u.video){let h=u.video.facingMode;h=h&&("object"==typeof h?h:{ideal:h});const b=e.version<66;if(h&&("user"===h.exact||"environment"===h.exact||"user"===h.ideal||"environment"===h.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||b)){let v;if(delete u.video.facingMode,"environment"===h.exact||"environment"===h.ideal?v=["back","rear"]:("user"===h.exact||"user"===h.ideal)&&(v=["front"]),v)return n.mediaDevices.enumerateDevices().then(O=>{let L=(O=O.filter(W=>"videoinput"===W.kind)).find(W=>v.some(Q=>W.label.toLowerCase().includes(Q)));return!L&&O.length&&v.includes("back")&&(L=O[O.length-1]),L&&(u.video.deviceId=h.exact?{exact:L.deviceId}:{ideal:L.deviceId}),u.video=r(u.video),qt("chrome: "+JSON.stringify(u)),p(u)})}u.video=r(u.video)}return qt("chrome: "+JSON.stringify(u)),p(u)},a=function(u){return e.version>=64?u:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[u.name]||u.name,message:u.message,constraint:u.constraint||u.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(u,p,h){i(u,b=>{n.webkitGetUserMedia(b,p,v=>{h&&h(a(v))})})}.bind(n),n.mediaDevices.getUserMedia){const u=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(p){return i(p,h=>u(h).then(b=>{if(h.audio&&!b.getAudioTracks().length||h.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(v=>{v.stop()}),new DOMException("","NotFoundError");return b},b=>Promise.reject(a(b))))}}}function re(t,e){if((!t.navigator.mediaDevices||!("getDisplayMedia"in t.navigator.mediaDevices))&&t.navigator.mediaDevices){if("function"!=typeof e)return void console.error("shimGetDisplayMedia: getSourceId argument is not a function");t.navigator.mediaDevices.getDisplayMedia=function(r){return e(r).then(i=>{const a=r.video&&r.video.width,l=r.video&&r.video.height;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:r.video&&r.video.frameRate||3}},a&&(r.video.mandatory.maxWidth=a),l&&(r.video.mandatory.maxHeight=l),t.navigator.mediaDevices.getUserMedia(r)})}}}function Ht(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function ye(t){if("object"==typeof t&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let a;a=t.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(u=>u.track&&u.track.id===i.track.id):{track:i.track};const l=new Event("track");l.track=i.track,l.receiver=a,l.transceiver={receiver:a},l.streams=[r.stream],this.dispatchEvent(l)}),r.stream.getTracks().forEach(i=>{let a;a=t.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(u=>u.track&&u.track.id===i.id):{track:i};const l=new Event("track");l.track=i,l.receiver=a,l.transceiver={receiver:a},l.streams=[r.stream],this.dispatchEvent(l)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Se(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function Ct(t){if("object"==typeof t&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(i,a){return{track:a,get dtmf(){return void 0===this._dtmf&&(this._dtmf="audio"===a.kind?i.createDTMFSender(a):null),this._dtmf},_pc:i}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(u,p){let h=i.apply(this,arguments);return h||(h=e(this,u),this._senders.push(h)),h};const a=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(u){a.apply(this,arguments);const p=this._senders.indexOf(u);-1!==p&&this._senders.splice(p,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(a){this._senders=this._senders||[],n.apply(this,[a]),a.getTracks().forEach(l=>{this._senders.push(e(this,l))})};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(a){this._senders=this._senders||[],r.apply(this,[a]),a.getTracks().forEach(l=>{const u=this._senders.find(p=>p.track===l);u&&this._senders.splice(this._senders.indexOf(u),1)})}}else if("object"==typeof t&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null),this._dtmf}})}}function Wt(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[r,i,a]=arguments;if(arguments.length>0&&"function"==typeof r)return e.apply(this,arguments);if(0===e.length&&(0===arguments.length||"function"!=typeof r))return e.apply(this,[]);const l=function(p){const h={};return p.result().forEach(v=>{const O={id:v.id,timestamp:v.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[v.type]||v.type};v.names().forEach(L=>{O[L]=v.stat(L)}),h[O.id]=O}),h},u=function(p){return new Map(Object.keys(p).map(h=>[h,p[h]]))};return arguments.length>=2?e.apply(this,[function(h){i(u(l(h)))},r]):new Promise((p,h)=>{e.apply(this,[function(b){p(u(l(b)))},h])}).then(i,a)}}function Yt(t){if(!("object"==typeof t&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const a=n.apply(this,[]);return a.forEach(l=>l._pc=this),a});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const a=r.apply(this,arguments);return a._pc=this,a}),t.RTCRtpSender.prototype.getStats=function(){const a=this;return this._pc.getStats().then(l=>Ve(l,a.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=n.apply(this,[]);return i.forEach(a=>a._pc=this),i}),Se(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(a=>Ve(a,i.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype)||!("getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const r=arguments[0];let i,a,l;return this.getSenders().forEach(u=>{u.track===r&&(i?l=!0:i=u)}),this.getReceivers().forEach(u=>(u.track===r&&(a?l=!0:a=u),u.track===r)),l||i&&a?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():a?a.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function Ge(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(l=>this._shimmedLocalStreams[l][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(l,u){if(!u)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const p=e.apply(this,arguments);return this._shimmedLocalStreams[u.id]?-1===this._shimmedLocalStreams[u.id].indexOf(p)&&this._shimmedLocalStreams[u.id].push(p):this._shimmedLocalStreams[u.id]=[u,p],p};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(l){this._shimmedLocalStreams=this._shimmedLocalStreams||{},l.getTracks().forEach(h=>{if(this.getSenders().find(v=>v.track===h))throw new DOMException("Track already exists.","InvalidAccessError")});const u=this.getSenders();n.apply(this,arguments);const p=this.getSenders().filter(h=>-1===u.indexOf(h));this._shimmedLocalStreams[l.id]=[l].concat(p)};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(l){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[l.id],r.apply(this,arguments)};const i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(l){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},l&&Object.keys(this._shimmedLocalStreams).forEach(u=>{const p=this._shimmedLocalStreams[u].indexOf(l);-1!==p&&this._shimmedLocalStreams[u].splice(p,1),1===this._shimmedLocalStreams[u].length&&delete this._shimmedLocalStreams[u]}),i.apply(this,arguments)}}function Xt(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return Ge(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const b=n.apply(this);return this._reverseStreams=this._reverseStreams||{},b.map(v=>this._reverseStreams[v.id])};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(b){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},b.getTracks().forEach(v=>{if(this.getSenders().find(L=>L.track===v))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[b.id]){const v=new t.MediaStream(b.getTracks());this._streams[b.id]=v,this._reverseStreams[v.id]=b,b=v}r.apply(this,[b])};const i=t.RTCPeerConnection.prototype.removeStream;function a(h,b){let v=b.sdp;return Object.keys(h._reverseStreams||[]).forEach(O=>{const L=h._reverseStreams[O];v=v.replace(new RegExp(h._streams[L.id].id,"g"),L.id)}),new RTCSessionDescription({type:b.type,sdp:v})}t.RTCPeerConnection.prototype.removeStream=function(b){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[b.id]||b]),delete this._reverseStreams[this._streams[b.id]?this._streams[b.id].id:b.id],delete this._streams[b.id]},t.RTCPeerConnection.prototype.addTrack=function(b,v){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const O=[].slice.call(arguments,1);if(1!==O.length||!O[0].getTracks().find(Q=>Q===b))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(Q=>Q.track===b))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const W=this._streams[v.id];if(W)W.addTrack(b),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const Q=new t.MediaStream([b]);this._streams[v.id]=Q,this._reverseStreams[Q.id]=v,this.addStream(Q)}return this.getSenders().find(Q=>Q.track===b)},["createOffer","createAnswer"].forEach(function(h){const b=t.RTCPeerConnection.prototype[h],v={[h](){const O=arguments;return arguments.length&&"function"==typeof arguments[0]?b.apply(this,[W=>{const Q=a(this,W);O[0].apply(null,[Q])},W=>{O[1]&&O[1].apply(null,W)},arguments[2]]):b.apply(this,arguments).then(W=>a(this,W))}};t.RTCPeerConnection.prototype[h]=v[h]});const u=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function l(h,b){let v=b.sdp;return Object.keys(h._reverseStreams||[]).forEach(O=>{const L=h._reverseStreams[O],W=h._streams[L.id];v=v.replace(new RegExp(L.id,"g"),W.id)}),new RTCSessionDescription({type:b.type,sdp:v})}(this,arguments[0]),u.apply(this,arguments)):u.apply(this,arguments)};const p=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const h=p.get.apply(this);return""===h.type?h:a(this,h)}}),t.RTCPeerConnection.prototype.removeTrack=function(b){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!b._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(b._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let O;this._streams=this._streams||{},Object.keys(this._streams).forEach(L=>{this._streams[L].getTracks().find(Q=>b.track===Q)&&(O=this._streams[L])}),O&&(1===O.getTracks().length?this.removeStream(this._reverseStreams[O.id]):O.removeTrack(b.track),this.dispatchEvent(new Event("negotiationneeded")))}}function vt(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=t.RTCPeerConnection.prototype[n],i={[n](){return arguments[0]=new("addIceCandidate"===n?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=i[n]})}function Zt(t,e){Se(t,"negotiationneeded",n=>{const r=n.target;if(!(e.version<72||r.getConfiguration&&"plan-b"===r.getConfiguration().sdpSemantics)||"stable"===r.signalingState)return n})}function Qt(t,e){const n=t&&t.navigator,r=t&&t.MediaStreamTrack;if(n.getUserMedia=function(i,a,l){_t("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(i).then(a,l)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const i=function(l,u,p){u in l&&!(p in l)&&(l[p]=l[u],delete l[u])},a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(l){return"object"==typeof l&&"object"==typeof l.audio&&(l=JSON.parse(JSON.stringify(l)),i(l.audio,"autoGainControl","mozAutoGainControl"),i(l.audio,"noiseSuppression","mozNoiseSuppression")),a(l)},r&&r.prototype.getSettings){const l=r.prototype.getSettings;r.prototype.getSettings=function(){const u=l.apply(this,arguments);return i(u,"mozAutoGainControl","autoGainControl"),i(u,"mozNoiseSuppression","noiseSuppression"),u}}if(r&&r.prototype.applyConstraints){const l=r.prototype.applyConstraints;r.prototype.applyConstraints=function(u){return"audio"===this.kind&&"object"==typeof u&&(u=JSON.parse(JSON.stringify(u)),i(u,"autoGainControl","mozAutoGainControl"),i(u,"noiseSuppression","mozNoiseSuppression")),l.apply(this,[u])}}}}function Rr(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return!0===r.video?r.video={mediaSource:e}:r.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(r)})}function er(t){"object"==typeof t&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Ke(t,e){if("object"!=typeof t||!t.RTCPeerConnection&&!t.mozRTCPeerConnection)return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const a=t.RTCPeerConnection.prototype[i],l={[i](){return arguments[0]=new("addIceCandidate"===i?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),a.apply(this,arguments)}};t.RTCPeerConnection.prototype[i]=l[i]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[a,l,u]=arguments;return r.apply(this,[a||null]).then(p=>{if(e.version<53&&!l)try{p.forEach(h=>{h.type=n[h.type]||h.type})}catch(h){if("TypeError"!==h.name)throw h;p.forEach((b,v)=>{p.set(v,Object.assign({},b,{type:n[b.type]||b.type}))})}return p}).then(l,u)}}function St(t){if("object"!=typeof t||!t.RTCPeerConnection||!t.RTCRtpSender||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(a=>a._pc=this),i});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const i=n.apply(this,arguments);return i._pc=this,i}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Je(t){if("object"!=typeof t||!t.RTCPeerConnection||!t.RTCRtpSender||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),Se(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function kt(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){_t("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function Tt(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function ke(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;void 0===r&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(l=>{if("rid"in l&&!/^[a-z0-9]{0,16}$/i.test(l.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in l&&!(parseFloat(l.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in l&&!(parseFloat(l.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const a=e.apply(this,arguments);if(i){const{sender:l}=a,u=l.getParameters();(!("encodings"in u)||1===u.encodings.length&&0===Object.keys(u.encodings[0]).length)&&(u.encodings=r,l.sendEncodings=r,this.setParametersPromises.push(l.setParameters(u).then(()=>{delete l.sendEncodings}).catch(()=>{delete l.sendEncodings})))}return a})}function Rt(t){if("object"!=typeof t||!t.RTCRtpSender)return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function Et(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function Er(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function Pt(t){if("object"==typeof t&&t.RTCPeerConnection){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},t.RTCPeerConnection.prototype.addTrack=function(r,...i){return i&&i.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(-1===r)return;this._localStreams.splice(r,1);const i=n.getTracks();this.getSenders().forEach(a=>{i.includes(a.track)&&this.removeTrack(a)})})}}function At(t){if("object"==typeof t&&t.RTCPeerConnection&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const a=new Event("addstream");a.stream=i,this.dispatchEvent(a)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(a=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(a)>=0)return;r._remoteStreams.push(a);const l=new Event("addstream");l.stream=a,r.dispatchEvent(l)})}),e.apply(r,arguments)}}}function tr(t){if("object"!=typeof t||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,a=e.setRemoteDescription,l=e.addIceCandidate;e.createOffer=function(h,b){const O=n.apply(this,[arguments.length>=2?arguments[2]:arguments[0]]);return b?(O.then(h,b),Promise.resolve()):O},e.createAnswer=function(h,b){const O=r.apply(this,[arguments.length>=2?arguments[2]:arguments[0]]);return b?(O.then(h,b),Promise.resolve()):O};let u=function(p,h,b){const v=i.apply(this,[p]);return b?(v.then(h,b),Promise.resolve()):v};e.setLocalDescription=u,u=function(p,h,b){const v=a.apply(this,[p]);return b?(v.then(h,b),Promise.resolve()):v},e.setRemoteDescription=u,u=function(p,h,b){const v=l.apply(this,[p]);return b?(v.then(h,b),Promise.resolve()):v},e.addIceCandidate=u}function Ot(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,r=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=i=>r(Pr(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=function(r,i,a){e.mediaDevices.getUserMedia(r).then(i,a)}.bind(e))}function Pr(t){return t&&void 0!==t.video?Object.assign({},t,{video:ot(t.video)}):t}function rr(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const a=[];for(let l=0;l<r.iceServers.length;l++){let u=r.iceServers[l];void 0===u.urls&&u.url?(_t("RTCIceServer.url","RTCIceServer.urls"),u=JSON.parse(JSON.stringify(u)),u.urls=u.url,delete u.url,a.push(u)):a.push(r.iceServers[l])}r.iceServers=a}return new e(r,i)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:()=>e.generateCertificate})}function nr(t){"object"==typeof t&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ir(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(l=>"audio"===l.receiver.track.kind);!1===r.offerToReceiveAudio&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0===r.offerToReceiveAudio&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const a=this.getTransceivers().find(l=>"video"===l.receiver.track.kind);!1===r.offerToReceiveVideo&&a?"sendrecv"===a.direction?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":"recvonly"===a.direction&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):!0===r.offerToReceiveVideo&&!a&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function qe(t){"object"!=typeof t||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var It=m(2917),Ie=m.n(It);function De(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(r){if("object"==typeof r&&r.candidate&&0===r.candidate.indexOf("a=")&&((r=JSON.parse(JSON.stringify(r))).candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),a=Ie().parseCandidate(r.candidate);for(const l in a)l in i||Object.defineProperty(i,l,{value:a[l]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},t.RTCIceCandidate.prototype=e.prototype,Se(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function He(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||Se(t,"icecandidate",e=>{if(e.candidate){const n=Ie().parseCandidate(e.candidate.candidate);"relay"===n.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function at(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const l=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===e.browser&&e.version>=76){const{sdpSemantics:p}=this.getConfiguration();"plan-b"===p&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(function(u){if(!u||!u.sdp)return!1;const p=Ie().splitSections(u.sdp);return p.shift(),p.some(h=>{const b=Ie().parseMLine(h);return b&&"application"===b.kind&&-1!==b.protocol.indexOf("SCTP")})}(arguments[0])){const p=function(u){const p=u.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===p||p.length<2)return-1;const h=parseInt(p[1],10);return h!=h?-1:h}(arguments[0]),h=function(u){let p=65536;return"firefox"===e.browser&&(p=e.version<57?-1===u?16384:2147483637:e.version<60?57===e.version?65535:65536:2147483637),p}(p),b=function(u,p){let h=65536;"firefox"===e.browser&&57===e.version&&(h=65535);const b=Ie().matchPrefix(u.sdp,"a=max-message-size:");return b.length>0?h=parseInt(b[0].substring(19),10):"firefox"===e.browser&&-1!==p&&(h=2147483637),h}(arguments[0],p);let v;v=0===h&&0===b?Number.POSITIVE_INFINITY:0===h||0===b?Math.max(h,b):Math.min(h,b);const O={};Object.defineProperty(O,"maxMessageSize",{get:()=>v}),this._sctp=O}return l.apply(this,arguments)}}function We(t){if(!t.RTCPeerConnection||!("createDataChannel"in t.RTCPeerConnection.prototype))return;function e(r,i){const a=r.send;r.send=function(){const u=arguments[0];if("open"===r.readyState&&i.sctp&&(u.length||u.size||u.byteLength)>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return a.apply(r,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const i=n.apply(this,arguments);return e(i,this),i},Se(t,"datachannel",r=>(e(r.channel,r.target),r))}function Dt(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const a=i.target;if(a._lastConnectionState!==a.connectionState){a._lastConnectionState=a.connectionState;const l=new Event("connectionstatechange",i);a.dispatchEvent(l)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function wt(t,e){if(!t.RTCPeerConnection||"chrome"===e.browser&&e.version>=71||"safari"===e.browser&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&-1!==i.sdp.indexOf("\na=extmap-allow-mixed")){const a=i.sdp.split("\n").filter(l=>"a=extmap-allow-mixed"!==l.trim()).join("\n");t.RTCSessionDescription&&i instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:i.type,sdp:a}):i.sdp=a}return n.apply(this,arguments)}}function ct(t,e){if(!t.RTCPeerConnection||!t.RTCPeerConnection.prototype)return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||0===n.length||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===e.browser&&e.version<78||"firefox"===e.browser&&e.version<68||"safari"===e.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function ft(t,e){if(!t.RTCPeerConnection||!t.RTCPeerConnection.prototype)return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||0===n.length||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if("object"!=typeof i||i.type&&i.sdp)return n.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer"}return i.sdp||"offer"!==i.type&&"answer"!==i.type?n.apply(this,[i]):("offer"===i.type?this.createOffer:this.createAnswer).apply(this).then(l=>n.apply(this,[l]))})}const or=function Ar({window:t}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const n=bt,r=function Tr(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.mozGetUserMedia)e.browser="firefox",e.version=st(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===t.isSecureContext&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=st(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!t.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return e.browser="Not a supported browser.",e;e.browser="safari",e.version=st(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype}return e}(t),i={browserDetails:r,commonShim:j,extractVersion:st,disableLog:kr,disableWarnings:Kt,sdp:It};switch(r.browser){case"chrome":if(!y||!vt||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(null===r.version)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=y,ct(t,r),ft(t),xt(t,r),Ht(t),vt(t,r),ye(t),Xt(t,r),Ct(t),Wt(t),Yt(t),Zt(t,r),De(t),He(t),Dt(t),at(t,r),We(t),wt(t,r);break;case"firefox":if(!S||!Ke||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=S,ct(t,r),ft(t),Qt(t,r),Ke(t,r),er(t),kt(t),St(t),Je(t),Tt(t),ke(t),Rt(t),Et(t),Er(t),De(t),Dt(t),at(t,r),We(t);break;case"safari":if(!A||!e.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=A,ct(t,r),ft(t),rr(t),ir(t),tr(t),Pt(t),At(t),nr(t),Ot(t),qe(t),De(t),He(t),at(t,r),We(t),wt(t,r);break;default:n("Unsupported browser!")}return i}({window:typeof window>"u"?void 0:window});function lt(t){return new ee(t,0)}function ar(t){var e={},n=!1;function r(i,a){return n=!0,{done:!1,value:new ee(a=new Promise(function(l){l(t[i](a))}),1)}}return e[typeof Symbol<"u"&&Symbol.iterator||"@@iterator"]=function(){return this},e.next=function(i){return n?(n=!1,i):r("next",i)},"function"==typeof t.throw&&(e.throw=function(i){if(n)throw n=!1,i;return r("throw",i)}),"function"==typeof t.return&&(e.return=function(i){return n?(n=!1,i):r("return",i)}),e}function Or(t){var e,n,r,i=2;for(typeof Symbol<"u"&&(n=Symbol.asyncIterator,r=Symbol.iterator);i--;){if(n&&null!=(e=t[n]))return e.call(t);if(r&&null!=(e=t[r]))return new ut(e.call(t));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function ut(t){function e(n){if(Object(n)!==n)return Promise.reject(new TypeError(n+" is not an object."));var r=n.done;return Promise.resolve(n.value).then(function(i){return{value:i,done:r}})}return(ut=function(r){this.s=r,this.n=r.next}).prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(r){var i=this.s.return;return void 0===i?Promise.resolve({value:r,done:!0}):e(i.apply(this.s,arguments))},throw:function(r){var i=this.s.return;return void 0===i?Promise.reject(r):e(i.apply(this.s,arguments))}},new ut(t)}let Mt;try{Mt=new TextDecoder}catch{}let I,Ce,C=0;const Ye=[],Ir=57342,Bt=57343,cr=57337,Ne={};let X,je,te,fe,oe,c,s,F=Ye,Xe=0,G={},se=0,Te=0,Y=[],we=[],o={useRecords:!1,mapsAsObjects:!0},f=!1,g=2;try{new Function("")}catch{g=1/0}class M{constructor(e){if(e&&((e.keyMap||e._keyMap)&&!e.useRecords&&(e.useRecords=!1,e.mapsAsObjects=!0),!1===e.useRecords&&void 0===e.mapsAsObjects&&(e.mapsAsObjects=!0),e.getStructures&&(e.getShared=e.getStructures),e.getShared&&!e.structures&&((e.structures=[]).uninitialized=!0),e.keyMap)){this.mapKey=new Map;for(let[n,r]of Object.entries(e.keyMap))this.mapKey.set(r,n)}Object.assign(this,e)}decodeKey(e){return this.keyMap&&this.mapKey.get(e)||e}encodeKey(e){return this.keyMap&&this.keyMap.hasOwnProperty(e)?this.keyMap[e]:e}encodeKeys(e){if(!this._keyMap)return e;let n=new Map;for(let[r,i]of Object.entries(e))n.set(this._keyMap.hasOwnProperty(r)?this._keyMap[r]:r,i);return n}decodeKeys(e){if(!this._keyMap||"Map"!=e.constructor.name)return e;if(!this._mapKey){this._mapKey=new Map;for(let[r,i]of Object.entries(this._keyMap))this._mapKey.set(i,r)}let n={};return e.forEach((r,i)=>n[ae(this._mapKey.has(i)?this._mapKey.get(i):i)]=r),n}mapDecode(e,n){let r=this.decode(e);return this._keyMap&&"Array"===r.constructor.name?r.map(i=>this.decodeKeys(i)):r}decode(e,n){if(I)return an(()=>(Lr(),this?this.decode(e,n):M.prototype.decode.call(o,e,n)));Ce=n>-1?n:e.length,C=0,Xe=0,Te=0,je=null,F=Ye,te=null,I=e;try{c=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw I=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&"object"==typeof e?e.constructor.name:typeof e))}if(this instanceof M){if(G=this,oe=this.sharedValues&&(this.pack?new Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),this.structures)return X=this.structures,K();(!X||X.length>0)&&(X=[])}else G=o,(!X||X.length>0)&&(X=[]),oe=null;return K()}decodeMultiple(e,n){let r,i=0;try{let a=e.length;f=!0;let l=this?this.decode(e,a):$r.decode(e,a);if(!n){for(r=[l];C<a;)i=C,r.push(K());return r}if(!1===n(l))return;for(;C<a;)if(i=C,!1===n(K()))return}catch(a){throw a.lastPosition=i,a.values=r,a}finally{f=!1,Lr()}}}function K(){try{let t=N();if(te){if(C>=te.postBundlePosition){let e=new Error("Unexpected bundle position");throw e.incomplete=!0,e}C=te.postBundlePosition,te=null}if(C==Ce)X=null,I=null,fe&&(fe=null);else{if(C>Ce){let e=new Error("Unexpected end of CBOR data");throw e.incomplete=!0,e}if(!f)throw new Error("Data read, but end of buffer not reached")}return t}catch(t){throw Lr(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function N(){let t=I[C++],e=t>>5;if(t&=31,t>23)switch(t){case 24:t=I[C++];break;case 25:if(7==e)return function Bn(){let t=I[C++],e=I[C++],n=(127&t)>>2;if(31===n)return e||3&t?NaN:128&t?-1/0:1/0;if(0===n){let r=((3&t)<<8|e)/16777216;return 128&t?-r:r}return pt[3]=128&t|56+(n>>1),pt[2]=(7&t)<<5|e>>3,pt[1]=e<<5,pt[0]=0,wr[0]}();t=c.getUint16(C),C+=2;break;case 26:if(7==e){let n=c.getFloat32(C);if(G.useFloat32>2){let r=hr[(127&I[C])<<1|I[C+1]>>7];return C+=4,(r*n+(n>0?.5:-.5)>>0)/r}return C+=4,n}t=c.getUint32(C),C+=4;break;case 27:if(7==e){let n=c.getFloat64(C);return C+=8,n}if(e>1){if(c.getUint32(C)>0)throw new Error("JavaScript does not support arrays, maps, or strings with length over 4294967295");t=c.getUint32(C+4)}else G.int64AsNumber?(t=4294967296*c.getUint32(C),t+=c.getUint32(C+4)):t=c.getBigUint64(C);C+=8;break;case 31:switch(e){case 2:case 3:throw new Error("Indefinite length not supported for byte or text strings");case 4:let r,n=[],i=0;for(;(r=N())!=Ne;)n[i++]=r;return 4==e?n:3==e?n.join(""):Buffer.concat(n);case 5:let a;if(G.mapsAsObjects){let l={};if(G.keyMap)for(;(a=N())!=Ne;)l[ae(G.decodeKey(a))]=N();else for(;(a=N())!=Ne;)l[ae(a)]=N();return l}{s&&(G.mapsAsObjects=!0,s=!1);let l=new Map;if(G.keyMap)for(;(a=N())!=Ne;)l.set(G.decodeKey(a),N());else for(;(a=N())!=Ne;)l.set(a,N());return l}case 7:return Ne;default:throw new Error("Invalid major type for indefinite length "+e)}default:throw new Error("Unknown token "+t)}switch(e){case 0:return t;case 1:return~t;case 2:return function Mn(t){return G.copyBuffers?Uint8Array.prototype.slice.call(I,C,C+=t):I.subarray(C,C+=t)}(t);case 3:if(Te>=C)return je.slice(C-se,(C+=t)-se);if(0==Te&&Ce<140&&t<32){let i=t<16?Dr(t):function rn(t){let e=C,n=new Array(t);for(let r=0;r<t;r++){const i=I[C++];if((128&i)>0)return void(C=e);n[r]=i}return le.apply(String,n)}(t);if(null!=i)return i}return Pe(t);case 4:let n=new Array(t);for(let i=0;i<t;i++)n[i]=N();return n;case 5:if(G.mapsAsObjects){let i={};if(G.keyMap)for(let a=0;a<t;a++)i[ae(G.decodeKey(N()))]=N();else for(let a=0;a<t;a++)i[ae(N())]=N();return i}{s&&(G.mapsAsObjects=!0,s=!1);let i=new Map;if(G.keyMap)for(let a=0;a<t;a++)i.set(G.decodeKey(N()),N());else for(let a=0;a<t;a++)i.set(N(),N());return i}case 6:if(t>=cr){let i=X[8191&t];if(i)return i.read||(i.read=dt(i)),i.read();if(t<65536){if(t==Bt){let a=yt(),l=N(),u=N();Mr(l,u);let p={};if(G.keyMap)for(let h=2;h<a;h++)p[ae(G.decodeKey(u[h-2]))]=N();else for(let h=2;h<a;h++)p[ae(u[h-2])]=N();return p}if(t==Ir){let a=yt(),l=N();for(let u=2;u<a;u++)Mr(l++,N());return N()}if(t==cr)return function Fn(){let t=yt(),e=C+N();for(let r=2;r<t;r++){let i=yt();C+=i}let n=C;return C=e,te=[ur(yt()),ur(yt())],te.position0=0,te.position1=0,te.postBundlePosition=C,C=n,N()}();if(G.getShared&&(Br(),i=X[8191&t],i))return i.read||(i.read=dt(i)),i.read()}}let r=Y[t];if(r)return r(r.handlesRead?N:N());{let i=N();for(let a=0;a<we.length;a++){let l=we[a](t,i);if(void 0!==l)return l}return new Ze(i,t)}case 7:switch(t){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;default:let i=(oe||Qe())[t];if(void 0!==i)return i;throw new Error("Unknown token "+t)}default:if(isNaN(t)){let i=new Error("Unexpected end of CBOR data");throw i.incomplete=!0,i}throw new Error("Unknown CBOR token "+t)}}const ve=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function dt(t){return t.slowReads=0,function e(){let n=I[C++];if(n&=31,n>23)switch(n){case 24:n=I[C++];break;case 25:n=c.getUint16(C),C+=2;break;case 26:n=c.getUint32(C),C+=4;break;default:throw new Error("Expected array header, but got "+I[C-1])}let r=this.compiledReader;for(;r;){if(r.propertyCount===n)return r(N);r=r.next}if(this.slowReads++>=g){let a=this.length==n?this:this.slice(0,n);return r=new Function("r",G.keyMap?"return {"+a.map(l=>G.decodeKey(l)).map(l=>ve.test(l)?ae(l)+":r()":"["+JSON.stringify(l)+"]:r()").join(",")+"}":"return {"+a.map(l=>ve.test(l)?ae(l)+":r()":"["+JSON.stringify(l)+"]:r()").join(",")+"}"),this.compiledReader&&(r.next=this.compiledReader),r.propertyCount=n,this.compiledReader=r,r(N)}let i={};if(G.keyMap)for(let a=0;a<n;a++)i[ae(G.decodeKey(this[a]))]=N();else for(let a=0;a<n;a++)i[ae(this[a])]=N();return i}}function ae(t){return"__proto__"===t?"__proto_":t}let Pe=ur;function ur(t){let e;if(t<16&&(e=Dr(t)))return e;if(t>64&&Mt)return Mt.decode(I.subarray(C,C+=t));const n=C+t,r=[];for(e="";C<n;){const i=I[C++];if(128&i)if(192==(224&i)){const a=63&I[C++];r.push((31&i)<<6|a)}else if(224==(240&i)){const a=63&I[C++],l=63&I[C++];r.push((31&i)<<12|a<<6|l)}else if(240==(248&i)){let p=(7&i)<<18|(63&I[C++])<<12|(63&I[C++])<<6|63&I[C++];p>65535&&(p-=65536,r.push(p>>>10&1023|55296),p=56320|1023&p),r.push(p)}else r.push(i);else r.push(i);r.length>=4096&&(e+=le.apply(String,r),r.length=0)}return r.length>0&&(e+=le.apply(String,r)),e}let le=String.fromCharCode;function Dr(t){if(t<4){if(t<2){if(0===t)return"";{let e=I[C++];return(128&e)>1?void(C-=1):le(e)}}{let e=I[C++],n=I[C++];if((128&e)>0||(128&n)>0)return void(C-=2);if(t<3)return le(e,n);let r=I[C++];return(128&r)>0?void(C-=3):le(e,n,r)}}{let e=I[C++],n=I[C++],r=I[C++],i=I[C++];if((128&e)>0||(128&n)>0||(128&r)>0||(128&i)>0)return void(C-=4);if(t<6){if(4===t)return le(e,n,r,i);{let a=I[C++];return(128&a)>0?void(C-=5):le(e,n,r,i,a)}}if(t<8){let a=I[C++],l=I[C++];if((128&a)>0||(128&l)>0)return void(C-=6);if(t<7)return le(e,n,r,i,a,l);let u=I[C++];return(128&u)>0?void(C-=7):le(e,n,r,i,a,l,u)}{let a=I[C++],l=I[C++],u=I[C++],p=I[C++];if((128&a)>0||(128&l)>0||(128&u)>0||(128&p)>0)return void(C-=8);if(t<10){if(8===t)return le(e,n,r,i,a,l,u,p);{let h=I[C++];return(128&h)>0?void(C-=9):le(e,n,r,i,a,l,u,p,h)}}if(t<12){let h=I[C++],b=I[C++];if((128&h)>0||(128&b)>0)return void(C-=10);if(t<11)return le(e,n,r,i,a,l,u,p,h,b);let v=I[C++];return(128&v)>0?void(C-=11):le(e,n,r,i,a,l,u,p,h,b,v)}{let h=I[C++],b=I[C++],v=I[C++],O=I[C++];if((128&h)>0||(128&b)>0||(128&v)>0||(128&O)>0)return void(C-=12);if(t<14){if(12===t)return le(e,n,r,i,a,l,u,p,h,b,v,O);{let L=I[C++];return(128&L)>0?void(C-=13):le(e,n,r,i,a,l,u,p,h,b,v,O,L)}}{let L=I[C++],W=I[C++];if((128&L)>0||(128&W)>0)return void(C-=14);if(t<15)return le(e,n,r,i,a,l,u,p,h,b,v,O,L,W);let Q=I[C++];return(128&Q)>0?void(C-=15):le(e,n,r,i,a,l,u,p,h,b,v,O,L,W,Q)}}}}}let wr=new Float32Array(1),pt=new Uint8Array(wr.buffer,0,4);new Array(4096);class Ze{constructor(e,n){this.value=e,this.tag=n}}Y[0]=t=>new Date(t),Y[1]=t=>new Date(Math.round(1e3*t)),Y[2]=t=>{let e=BigInt(0);for(let n=0,r=t.byteLength;n<r;n++)e=BigInt(t[n])+e<<BigInt(8);return e},Y[3]=t=>BigInt(-1)-Y[2](t),Y[4]=t=>+(t[1]+"e"+t[0]),Y[5]=t=>t[1]*Math.exp(t[0]*Math.log(2));const Mr=(t,e)=>{let n=X[t-=57344];n&&n.isShared&&((X.restoreStructures||(X.restoreStructures=[]))[t]=n),X[t]=e,e.read=dt(e)};Y[105]=t=>{let e=t.length,n=t[1];Mr(t[0],n);let r={};for(let i=2;i<e;i++)r[ae(n[i-2])]=t[i];return r},Y[14]=t=>te?te[0].slice(te.position0,te.position0+=t):new Ze(t,14),Y[15]=t=>te?te[1].slice(te.position1,te.position1+=t):new Ze(t,15);let Ln={Error,RegExp};Y[27]=t=>(Ln[t[0]]||Error)(t[1],t[2]);const sn=t=>{if(132!=I[C++])throw new Error("Packed values structure must be followed by a 4 element array");let e=t();return oe=oe?e.concat(oe.slice(e.length)):e,oe.prefixes=t(),oe.suffixes=t(),t()};function mt(t,e){return"string"==typeof t?t+e:t instanceof Array?t.concat(e):Object.assign({},t,e)}function Qe(){if(!oe){if(!G.getShared)throw new Error("No packed values available");Br()}return oe}sn.handlesRead=!0,Y[51]=sn,Y[6]=t=>{if(!oe){if(!G.getShared)return new Ze(t,6);Br()}if("number"==typeof t)return oe[16+(t>=0?2*t:-2*t-1)];throw new Error("No support for non-integer packed references yet")},Y[28]=t=>{fe||(fe=new Map,fe.id=0);let r,e=fe.id++;r=I[C]>>5==4?[]:{};let i={target:r};fe.set(e,i);let a=t();return i.used?Object.assign(r,a):(i.target=a,a)},Y[28].handlesRead=!0,Y[29]=t=>{let e=fe.get(t);return e.used=!0,e.target},Y[258]=t=>new Set(t),(Y[259]=t=>(G.mapsAsObjects&&(G.mapsAsObjects=!1,s=!0),t())).handlesRead=!0,we.push((t,e)=>t>=225&&t<=255?mt(Qe().prefixes[t-224],e):t>=28704&&t<=32767?mt(Qe().prefixes[t-28672],e):t>=1879052288&&t<=2147483647?mt(Qe().prefixes[t-1879048192],e):t>=216&&t<=223?mt(e,Qe().suffixes[t-216]):t>=27647&&t<=28671?mt(e,Qe().suffixes[t-27639]):t>=1811940352&&t<=1879048191?mt(e,Qe().suffixes[t-1811939328]):1399353956==t?{packedValues:oe,structures:X.slice(0),version:e}:55799==t?e:void 0);const Un=1==new Uint8Array(new Uint16Array([1]).buffer)[0],on=[Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?{name:"BigUint64Array"}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?{name:"BigInt64Array"}:BigInt64Array,Float32Array,Float64Array],Nn=[64,68,69,70,71,72,77,78,79,85,86];for(let t=0;t<on.length;t++)jn(on[t],Nn[t]);function jn(t,e){let r,n="get"+t.name.slice(0,-5);"function"==typeof t?r=t.BYTES_PER_ELEMENT:t=null;for(let i=0;i<2;i++){if(!i&&1==r)continue;let a=2==r?1:4==r?2:3;Y[i?e:e-4]=1==r||i==Un?l=>{if(!t)throw new Error("Could not find typed array for code "+e);return new t(Uint8Array.prototype.slice.call(l,0).buffer)}:l=>{if(!t)throw new Error("Could not find typed array for code "+e);let u=new DataView(l.buffer,l.byteOffset,l.byteLength),p=l.length>>a,h=new t(p),b=u[n];for(let v=0;v<p;v++)h[v]=b.call(u,v<<a,i);return h}}}function yt(){let t=31&I[C++];if(t>23)switch(t){case 24:t=I[C++];break;case 25:t=c.getUint16(C),C+=2;break;case 26:t=c.getUint32(C),C+=4}return t}function Br(){if(G.getShared){let t=an(()=>(I=null,G.getShared()))||{},e=t.structures||[];G.sharedVersion=t.version,oe=G.sharedValues=t.packedValues,!0===X?G.structures=X=e:X.splice.apply(X,[0,e.length].concat(e))}}function an(t){let e=Ce,n=C,r=Xe,i=se,a=Te,l=je,u=F,p=fe,h=te,b=new Uint8Array(I.slice(0,Ce)),v=X,O=G,L=f,W=t();return Ce=e,C=n,Xe=r,se=i,Te=a,je=l,F=u,fe=p,te=h,I=b,f=L,X=v,G=O,c=new DataView(I.buffer,I.byteOffset,I.byteLength),W}function Lr(){I=null,fe=null,X=null}const hr=new Array(147);for(let t=0;t<256;t++)hr[t]=+("1e"+Math.floor(45.15-.30103*t));let dr,pr,Ur,$r=new M({useRecords:!1});try{dr=new TextEncoder}catch{}const mr="object"==typeof globalThis&&globalThis.Buffer,Lt=typeof mr<"u",Nr=Lt?mr.allocUnsafeSlow:Uint8Array,cn=Lt?mr:Uint8Array,ln=Lt?4294967296:2144337920;let jr,_,Z,Fe,d=0,ce=null;const Gn=/[\u0080-\uFFFF]/,xe=Symbol("record-id");function un(t,e){t<24?_[d++]=e|t:t<256?(_[d++]=24|e,_[d++]=t):t<65536?(_[d++]=25|e,_[d++]=t>>8,_[d++]=255&t):(_[d++]=26|e,Z.setUint32(d,t),d+=4)}class hn{constructor(e,n,r){this.structures=e,this.packedValues=n,this.version=r}}function Ae(t){t<24?_[d++]=128|t:t<256?(_[d++]=152,_[d++]=t):t<65536?(_[d++]=153,_[d++]=t>>8,_[d++]=255&t):(_[d++]=154,Z.setUint32(d,t),d+=4)}const Jn=typeof Blob>"u"?function(){}:Blob;function Fr(t){if(t instanceof Jn)return!0;let e=t[Symbol.toStringTag];return"Blob"===e||"File"===e}function yr(t,e){switch(typeof t){case"string":if(t.length>3){if(e.objectMap[t]>-1||e.values.length>=e.maxValues)return;let r=e.get(t);if(r)2==++r.count&&e.values.push(t);else if(e.set(t,{count:1}),e.samplingPackedValues){let i=e.samplingPackedValues.get(t);i?i.count++:e.samplingPackedValues.set(t,{count:1})}}break;case"object":if(t)if(t instanceof Array)for(let r=0,i=t.length;r<i;r++)yr(t[r],e);else{let r=!e.encoder.useRecords;for(var n in t)t.hasOwnProperty(n)&&(r&&yr(n,e),yr(t[n],e))}break;case"function":console.log(t)}}const qn=1==new Uint8Array(new Uint16Array([1]).buffer)[0];function Oe(t,e){return!qn&&e>1&&(t-=4),{tag:t,encode:function(r,i){let a=r.byteLength,l=r.byteOffset||0,u=r.buffer||r;i(Lt?mr.from(u,l,a):new Uint8Array(u,l,a))}}}function dn(t,e){let n=t.byteLength;n<24?_[d++]=64+n:n<256?(_[d++]=88,_[d++]=n):n<65536?(_[d++]=89,_[d++]=n>>8,_[d++]=255&n):(_[d++]=90,Z.setUint32(d,n),d+=4),d+n>=_.length&&e(d+n),_.set(t.buffer?t:new Uint8Array(t),d),d+=n}function pn(t,e){Z.setUint32(ce.position+t,d-ce.position-t+1);let n=ce;ce=null,e(n[0]),e(n[1])}Ur=[Date,Set,Error,RegExp,Ze,ArrayBuffer,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?function(){}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?function(){}:BigInt64Array,Float32Array,Float64Array,hn],pr=[{tag:1,encode(t,e){let n=t.getTime()/1e3;(this.useTimestamp32||0===t.getMilliseconds())&&n>=0&&n<4294967296?(_[d++]=26,Z.setUint32(d,n),d+=4):(_[d++]=251,Z.setFloat64(d,n),d+=8)}},{tag:258,encode(t,e){e(Array.from(t))}},{tag:27,encode(t,e){e([t.name,t.message])}},{tag:27,encode(t,e){e(["RegExp",t.source,t.flags])}},{getTag:t=>t.tag,encode(t,e){e(t.value)}},{encode(t,e,n){dn(t,n)}},{getTag(t){if(t.constructor===Uint8Array&&(this.tagUint8Array||Lt&&!1!==this.tagUint8Array))return 64},encode(t,e,n){dn(t,n)}},Oe(68,1),Oe(69,2),Oe(70,4),Oe(71,8),Oe(72,1),Oe(77,2),Oe(78,4),Oe(79,8),Oe(85,4),Oe(86,8),{encode(t,e){let n=t.packedValues||[],r=t.structures||[];if(n.values.length>0){_[d++]=216,_[d++]=51,Ae(4);let i=n.values;e(i),Ae(0),Ae(0),packedObjectMap=Object.create(sharedPackedObjectMap||null);for(let a=0,l=i.length;a<l;a++)packedObjectMap[i[a]]=a}if(r){Z.setUint32(d,3655335424),d+=3;let i=r.slice(0);i.unshift(57344),i.push(new Ze(t.version,1399353956)),e(i)}else e(new Ze(t.version,1399353956))}}],new class Kn extends M{constructor(e){let r,i,a,l,u;super(e),this.offset=0;let p=cn.prototype.utf8Write?function(x,D,E){return _.utf8Write(x,D,E)}:!(!dr||!dr.encodeInto)&&function(x,D){return dr.encodeInto(x,_.subarray(D)).written},h=this,v=(e=e||{}).maxSharedStructures;if(null==v&&(v=e.structures||e.saveStructures?128:0),v>8190)throw new Error("Maximum maxSharedStructure is 8190");let O=e.sequential;O&&(v=0),this.structures||(this.structures=[]),this.saveStructures&&(this.saveShared=this.saveStructures);let L,W,Ee,Q=e.sharedValues;if(Q){Ee=Object.create(null);for(let x=0,D=Q.length;x<D;x++)Ee[Q[x]]=x}let Le=[],Xr=0,Cr=0;this.mapEncode=function(x,D){return this._keyMap&&!this._mapped&&"Array"===x.constructor.name&&(x=x.map(E=>this.encodeKeys(E))),this.encode(x,D)},this.encode=function(x,D){if(_||(_=new Nr(8192),Z=new DataView(_.buffer,0,8192),d=0),Fe=_.length-10,Fe-d<2048?(_=new Nr(_.length),Z=new DataView(_.buffer,0,_.length),Fe=_.length-10,d=0):D===mn&&(d=d+7&2147483640),r=d,h.useSelfDescribedHeader&&(Z.setUint32(d,3654940416),d+=3),u=h.structuredClone?new Map:null,h.bundleStrings&&"string"!=typeof x?(ce=[],ce.size=1/0):ce=null,i=h.structures,i){if(i.uninitialized){let P=h.getShared()||{};h.structures=i=P.structures||[],h.sharedVersion=P.version;let R=h.sharedValues=P.packedValues;if(R){Ee={};for(let B=0,U=R.length;B<U;B++)Ee[R[B]]=B}}let E=i.length;if(E>v&&!O&&(E=v),!i.transitions){i.transitions=Object.create(null);for(let P=0;P<E;P++){let R=i[P];if(!R)continue;let B,U=i.transitions;for(let $=0,V=R.length;$<V;$++){void 0===U[xe]&&(U[xe]=P);let z=R[$];B=U[z],B||(B=U[z]=Object.create(null)),U=B}U[xe]=1048576|P}}O||(i.nextId=E)}if(a&&(a=!1),l=i||[],W=Ee,e.pack){let E=new Map;if(E.values=[],E.encoder=h,E.maxValues=e.maxPrivatePackedValues||(Ee?16:1/0),E.objectMap=Ee||!1,E.samplingPackedValues=L,yr(x,E),E.values.length>0){_[d++]=216,_[d++]=51,Ae(4);let P=E.values;J(P),Ae(0),Ae(0),W=Object.create(Ee||null);for(let R=0,B=P.length;R<B;R++)W[P[R]]=R}}jr=D&Vr;try{if(jr)return;if(J(x),ce&&pn(r,J),h.offset=d,u&&u.idsToInsert){d+=2*u.idsToInsert.length,d>Fe&&Ft(d),h.offset=d;let E=function Hn(t,e){let n,r=2*e.length,i=t.length-r;e.sort((a,l)=>a.offset>l.offset?1:-1);for(let a=0;a<e.length;a++){let l=e[a];l.id=a;for(let u of l.references)t[u++]=a>>8,t[u]=255&a}for(;n=e.pop();){let a=n.offset;t.copyWithin(a+r,a,i),r-=2;let l=a+r;t[l++]=216,t[l++]=28,i=a}return t}(_.subarray(r,d),u.idsToInsert);return u=null,E}return D&mn?(_.start=r,_.end=d,_):_.subarray(r,d)}finally{if(i)if(Cr<10&&Cr++,i.length>v&&(i.length=v),Xr>1e4)i.transitions=null,Cr=0,Xr=0,Le.length>0&&(Le=[]);else if(Le.length>0&&!O){for(let E=0,P=Le.length;E<P;E++)Le[E][xe]=void 0;Le=[]}if(a&&h.saveShared){h.structures.length>v&&(h.structures=h.structures.slice(0,v));let E=_.subarray(r,d);return!1===h.updateSharedData()?h.encode(x):E}D&Wn&&(d=r)}},this.findCommonStringsToPack=()=>(L=new Map,Ee||(Ee=Object.create(null)),x=>{let D=x&&x.threshold||4,E=this.pack?x.maxPrivatePackedValues||16:0;Q||(Q=this.sharedValues=[]);for(let[P,R]of L)R.count>D&&(Ee[P]=E++,Q.push(P),a=!0);for(;this.saveShared&&!1===this.updateSharedData(););L=null});const J=x=>{d>Fe&&(_=Ft(d));var E,D=typeof x;if("string"===D){if(W){let U=W[x];if(U>=0)return void(U<16?_[d++]=U+224:(_[d++]=198,J(1&U?15-U>>1:U-16>>1)));if(L&&!e.pack){let $=L.get(x);$?$.count++:L.set(x,{count:1})}}let R,P=x.length;if(ce&&P>=4&&P<1024){if((ce.size+=P)>61440){let $,V=(ce[0]?3*ce[0].length+ce[1].length:0)+10;d+V>Fe&&(_=Ft(d+V)),_[d++]=217,_[d++]=223,_[d++]=249,_[d++]=ce.position?132:130,_[d++]=26,$=d-r,d+=4,ce.position&&pn(r,J),ce=["",""],ce.size=0,ce.position=$}let U=Gn.test(x);return ce[U?0:1]+=x,_[d++]=U?206:207,void J(P)}R=P<32?1:P<256?2:P<65536?3:5;let B=3*P;if(d+B>Fe&&(_=Ft(d+B)),P<64||!p){let U,$,V,z=d+R;for(U=0;U<P;U++)$=x.charCodeAt(U),$<128?_[z++]=$:$<2048?(_[z++]=$>>6|192,_[z++]=63&$|128):55296==(64512&$)&&56320==(64512&(V=x.charCodeAt(U+1)))?($=65536+((1023&$)<<10)+(1023&V),U++,_[z++]=$>>18|240,_[z++]=$>>12&63|128,_[z++]=$>>6&63|128,_[z++]=63&$|128):(_[z++]=$>>12|224,_[z++]=$>>6&63|128,_[z++]=63&$|128);E=z-d-R}else E=p(x,d+R,B);E<24?_[d++]=96|E:E<256?(R<2&&_.copyWithin(d+2,d+1,d+1+E),_[d++]=120,_[d++]=E):E<65536?(R<3&&_.copyWithin(d+3,d+2,d+2+E),_[d++]=121,_[d++]=E>>8,_[d++]=255&E):(R<5&&_.copyWithin(d+5,d+3,d+3+E),_[d++]=122,Z.setUint32(d,E),d+=4),d+=E}else if("number"===D)if(this.alwaysUseFloat||x>>>0!==x)if(this.alwaysUseFloat||x>>0!==x){let P;if((P=this.useFloat32)>0&&x<4294967296&&x>=-2147483648){let R;if(_[d++]=250,Z.setFloat32(d,x),P<4||(R=x*hr[(127&_[d])<<1|_[d+1]>>7])>>0===R)return void(d+=4);d--}_[d++]=251,Z.setFloat64(d,x),d+=8}else x>=-24?_[d++]=31-x:x>=-256?(_[d++]=56,_[d++]=~x):x>=-65536?(_[d++]=57,Z.setUint16(d,~x),d+=2):(_[d++]=58,Z.setUint32(d,~x),d+=4);else x<24?_[d++]=x:x<256?(_[d++]=24,_[d++]=x):x<65536?(_[d++]=25,_[d++]=x>>8,_[d++]=255&x):(_[d++]=26,Z.setUint32(d,x),d+=4);else if("object"===D)if(x){if(u){let R=u.get(x);if(R){if(_[d++]=216,_[d++]=29,_[d++]=25,!R.references){let B=u.idsToInsert||(u.idsToInsert=[]);R.references=[],B.push(R)}return R.references.push(d-r),void(d+=2)}u.set(x,{offset:d-r})}let P=x.constructor;if(P===Object)Zr(x,!0);else if(P===Array){(E=x.length)<24?_[d++]=128|E:Ae(E);for(let R=0;R<E;R++)J(x[R])}else if(P===Map)if((this.mapsAsObjects?!1!==this.useTag259ForMaps:this.useTag259ForMaps)&&(_[d++]=217,_[d++]=1,_[d++]=3),(E=x.size)<24?_[d++]=160|E:E<256?(_[d++]=184,_[d++]=E):E<65536?(_[d++]=185,_[d++]=E>>8,_[d++]=255&E):(_[d++]=186,Z.setUint32(d,E),d+=4),h.keyMap)for(let[R,B]of x)J(h.encodeKey(R)),J(B);else for(let[R,B]of x)J(R),J(B);else{for(let R=0,B=pr.length;R<B;R++)if(x instanceof Ur[R]){let $=pr[R],V=$.tag;return null==V&&(V=$.getTag&&$.getTag.call(this,x)),V<24?_[d++]=192|V:V<256?(_[d++]=216,_[d++]=V):V<65536?(_[d++]=217,_[d++]=V>>8,_[d++]=255&V):V>-1&&(_[d++]=218,Z.setUint32(d,V),d+=4),void $.encode.call(this,x,J,Ft)}if(x[Symbol.iterator]){if(jr){let R=new Error("Iterable should be serialized as iterator");throw R.iteratorNotHandled=!0,R}_[d++]=159;for(let R of x)J(R);return void(_[d++]=255)}if(x[Symbol.asyncIterator]||Fr(x)){let R=new Error("Iterable/blob should be serialized as iterator");throw R.iteratorNotHandled=!0,R}if(this.useToJSON&&x.toJSON){const R=x.toJSON();if(R!==x)return J(R)}Zr(x,!x.hasOwnProperty)}}else _[d++]=246;else if("boolean"===D)_[d++]=x?245:244;else if("bigint"===D){if(x<BigInt(1)<<BigInt(64)&&x>=0)_[d++]=27,Z.setBigUint64(d,x);else if(x>-(BigInt(1)<<BigInt(64))&&x<0)_[d++]=59,Z.setBigUint64(d,-x-BigInt(1));else{if(!this.largeBigIntToFloat)throw new RangeError(x+" was too large to fit in CBOR 64-bit integer format, set largeBigIntToFloat to convert to float-64");_[d++]=251,Z.setFloat64(d,Number(x))}d+=8}else{if("undefined"!==D)throw new Error("Unknown type: "+D);_[d++]=247}},Zr=!1===this.useRecords?this.variableMapSize?x=>{let D=Object.keys(x),E=Object.values(x),P=D.length;if(P<24?_[d++]=160|P:P<256?(_[d++]=184,_[d++]=P):P<65536?(_[d++]=185,_[d++]=P>>8,_[d++]=255&P):(_[d++]=186,Z.setUint32(d,P),d+=4),h.keyMap)for(let B=0;B<P;B++)J(h.encodeKey(D[B])),J(E[B]);else for(let B=0;B<P;B++)J(D[B]),J(E[B])}:(x,D)=>{_[d++]=185;let E=d-r;d+=2;let P=0;if(h.keyMap)for(let R in x)(D||x.hasOwnProperty(R))&&(J(h.encodeKey(R)),J(x[R]),P++);else for(let R in x)(D||x.hasOwnProperty(R))&&(J(R),J(x[R]),P++);_[E+++r]=P>>8,_[E+r]=255&P}:(x,D)=>{let E,U,$,P=l.transitions||(l.transitions=Object.create(null)),R=0,B=0;if(this.keyMap){$=Object.keys(x).map(z=>this.encodeKey(z)),B=$.length;for(let z=0;z<B;z++){let Vt=$[z];E=P[Vt],E||(E=P[Vt]=Object.create(null),R++),P=E}}else for(let z in x)(D||x.hasOwnProperty(z))&&(E=P[z],E||(1048576&P[xe]&&(U=65535&P[xe]),E=P[z]=Object.create(null),R++),P=E,B++);let V=P[xe];if(void 0!==V)V&=65535,_[d++]=217,_[d++]=V>>8|224,_[d++]=255&V;else{if($||($=P.__keys__||(P.__keys__=Object.keys(x))),void 0===U?(V=l.nextId++,V||(V=0,l.nextId=1),V>=256&&(l.nextId=(V=v)+1)):V=U,l[V]=$,!(V<v)){if(P[xe]=V,Z.setUint32(d,3655335680),d+=3,R&&(Xr+=Cr*R),Le.length>=256-v&&(Le.shift()[xe]=void 0),Le.push(P),Ae(B+2),J(57344+V),J($),null===D)return;for(let z in x)(D||x.hasOwnProperty(z))&&J(x[z]);return}_[d++]=217,_[d++]=V>>8|224,_[d++]=255&V,P=l.transitions;for(let z=0;z<B;z++)(void 0===P[xe]||1048576&P[xe])&&(P[xe]=V),P=P[$[z]];P[xe]=1048576|V,a=!0}if(B<24?_[d++]=128|B:Ae(B),null!==D)for(let z in x)(D||x.hasOwnProperty(z))&&J(x[z])},Ft=x=>{let D;if(x>16777216){if(x-r>ln)throw new Error("Encoded buffer would be larger than maximum buffer size");D=Math.min(ln,4096*Math.round(Math.max((x-r)*(x>67108864?1.25:2),4194304)/4096))}else D=1+(Math.max(x-r<<2,_.length-1)>>12)<<12;let E=new Nr(D);return Z=new DataView(E.buffer,0,D),_.copy?_.copy(E,0,r,x):E.set(_.slice(r,x)),d-=r,r=0,Fe=E.length-10,_=E};let nt=100,En=1e3;function*gt(x,D,E){let P=x.constructor;if(P===Object){let R=!1!==h.useRecords;R?Zr(x,null):un(Object.keys(x).length,160);for(let B in x){let U=x[B];R||J(B),U&&"object"==typeof U?D[B]?yield*gt(U,D[B]):yield*Qr(U,D,B):J(U)}}else if(P===Array){let R=x.length;Ae(R);for(let B=0;B<R;B++){let U=x[B];U&&("object"==typeof U||d-r>nt)?D.element?yield*gt(U,D.element):yield*Qr(U,D,"element"):J(U)}}else if(x[Symbol.iterator]){_[d++]=159;for(let R of x)R&&("object"==typeof R||d-r>nt)?D.element?yield*gt(R,D.element):yield*Qr(R,D,"element"):J(R);_[d++]=255}else Fr(x)?(un(x.size,64),yield _.subarray(r,d),yield x,zt()):x[Symbol.asyncIterator]?(_[d++]=159,yield _.subarray(r,d),yield x,zt(),_[d++]=255):J(x);E&&d>r?yield _.subarray(r,d):d-r>nt&&(yield _.subarray(r,d),zt())}function*Qr(x,D,E){let P=d-r;try{J(x),d-r>nt&&(yield _.subarray(r,d),zt())}catch(R){if(!R.iteratorNotHandled)throw R;D[E]={},d=r+P,yield*gt.call(this,x,D[E])}}function zt(){nt=En,h.encode(null,Vr)}function Pn(x,D,E){return nt=D&&D.chunkThreshold?En=D.chunkThreshold:100,x&&"object"==typeof x?(h.encode(null,Vr),E(x,h.iterateProperties||(h.iterateProperties={}),!0)):[h.encode(x)]}function An(x,D){return en.apply(this,arguments)}function en(){return en=function ie(t){return function(){return new de(t.apply(this,arguments))}}(function*(x,D){for(let $ of gt(x,D,!0)){let V=$.constructor;if(V===cn||V===Uint8Array)yield $;else if(Fr($)){let Vt,z=$.stream().getReader();for(;!(Vt=yield lt(z.read())).done;)yield Vt.value}else if($[Symbol.asyncIterator]){var R,E=!1,P=!1;try{for(var U,B=Or($);E=!(U=yield lt(B.next())).done;E=!1){let z=U.value;zt(),z?yield*ar(Or(An(z,D.async||(D.async={})))):yield h.encode(z)}}catch(z){P=!0,R=z}finally{try{E&&null!=B.return&&(yield lt(B.return()))}finally{if(P)throw R}}}else yield $}}),en.apply(this,arguments)}this.encodeAsIterable=function(x,D){return Pn(x,D,gt)},this.encodeAsAsyncIterable=function(x,D){return Pn(x,D,An)}}useBuffer(e){_=e,Z=new DataView(_.buffer,_.byteOffset,_.byteLength),d=0}clearSharedData(){this.structures&&(this.structures=[]),this.sharedValues&&(this.sharedValues=void 0)}updateSharedData(){let e=this.sharedVersion||0;this.sharedVersion=e+1;let n=this.structures.slice(0),r=new hn(n,this.sharedValues,this.sharedVersion),i=this.saveShared(r,a=>(a&&a.version||0)==e);return!1===i?(r=this.getShared()||{},this.structures=r.structures||[],this.sharedValues=r.packedValues,this.sharedVersion=r.version,this.structures.nextId=this.structures.length):n.forEach((a,l)=>this.structures[l]=a),i}}({useRecords:!1});const mn=512,Wn=1024,Vr=2048;var Kr;function et(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}class bn{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=e=>{const n=[],r=e.byteLength,i=Math.ceil(r/this.chunkedMTU);let a=0,l=0;for(;l<r;){const u=Math.min(r,l+this.chunkedMTU),p=e.slice(l,u);n.push({__peerData:this._dataCount,n:a,data:p,total:i}),l=u,a++}return this._dataCount++,n}}}const Jr=or.default||or,$t=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const t=this.getBrowser(),e=this.getVersion();return!!this.supportedBrowsers.includes(t)&&("chrome"===t?e>=this.minChromeVersion:"firefox"===t?e>=this.minFirefoxVersion:"safari"===t&&!this.isIOS&&e>=this.minSafariVersion)}getBrowser(){return Jr.browserDetails.browser}getVersion(){return Jr.browserDetails.version||0}isUnifiedPlanSupported(){const t=this.getBrowser(),e=Jr.browserDetails.version||0;if("chrome"===t&&e<this.minChromeVersion)return!1;if("firefox"===t&&e>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let n,r=!1;try{n=new RTCPeerConnection,n.addTransceiver("audio"),r=!0}catch{}finally{n&&n.close()}return r}toString(){return`Supports:\n    browser:${this.getBrowser()}\n    version:${this.getVersion()}\n    isIOS:${this.isIOS}\n    isWebRTCSupported:${this.isWebRTCSupported()}\n    isBrowserSupported:${this.isBrowserSupported()}\n    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},Qn=t=>!t||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(t),_n=()=>Math.random().toString(36).slice(2),xn={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"},_e=new class ei extends bn{noop(){}blobToArrayBuffer(e,n){const r=new FileReader;return r.onload=function(i){i.target&&n(i.target.result)},r.readAsArrayBuffer(e),r}binaryStringToArrayBuffer(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=255&e.charCodeAt(r);return n.buffer}isSecure(){return"https:"===location.protocol}constructor(...e){super(...e),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=xn,this.browser=$t.getBrowser(),this.browserVersion=$t.getVersion(),this.pack=it,this.unpack=be,this.supports=function(){const n={browser:$t.isBrowserSupported(),webRTC:$t.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!n.webRTC)return n;let r;try{let i;r=new RTCPeerConnection(xn),n.audioVideo=!0;try{i=r.createDataChannel("_PEERJSTEST",{ordered:!0}),n.data=!0,n.reliable=!!i.ordered;try{i.binaryType="blob",n.binaryBlob=!$t.isIOS}catch{}}catch{}finally{i&&i.close()}}catch{}finally{r&&r.close()}return n}(),this.validateId=Qn,this.randomToken=_n}};var qr,Re=function(t){return t[t.Disabled=0]="Disabled",t[t.Errors=1]="Errors",t[t.Warnings=2]="Warnings",t[t.All=3]="All",t}(Re||{}),w=new class ri{get logLevel(){return this._logLevel}set logLevel(e){this._logLevel=e}log(...e){this._logLevel>=Re.All&&this._print(Re.All,...e)}warn(...e){this._logLevel>=Re.Warnings&&this._print(Re.Warnings,...e)}error(...e){this._logLevel>=Re.Errors&&this._print(Re.Errors,...e)}setLogFunction(e){this._print=e}_print(e,...n){const r=["PeerJS: ",...n];for(const i in r)r[i]instanceof Error&&(r[i]="("+r[i].name+") "+r[i].message);e>=Re.All?console.log(...r):e>=Re.Warnings?console.warn("WARNING",...r):e>=Re.Errors&&console.error("ERROR",...r)}constructor(){this._logLevel=Re.Disabled}},ni=Object.prototype.hasOwnProperty,ge="~";function Ut(){}function ii(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function Cn(t,e,n,r,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new ii(n,r||t,i),l=ge?ge+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],a]:t._events[l].push(a):(t._events[l]=a,t._eventsCount++),t}function gr(t,e){0==--t._eventsCount?t._events=new Ut:delete t._events[e]}function me(){this._events=new Ut,this._eventsCount=0}Object.create&&(Ut.prototype=Object.create(null),(new Ut).__proto__||(ge=!1)),me.prototype.eventNames=function(){var n,r,e=[];if(0===this._eventsCount)return e;for(r in n=this._events)ni.call(n,r)&&e.push(ge?r.slice(1):r);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(n)):e},me.prototype.listeners=function(e){var r=this._events[ge?ge+e:e];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,a=r.length,l=new Array(a);i<a;i++)l[i]=r[i].fn;return l},me.prototype.listenerCount=function(e){var r=this._events[ge?ge+e:e];return r?r.fn?1:r.length:0},me.prototype.emit=function(e,n,r,i,a,l){var u=ge?ge+e:e;if(!this._events[u])return!1;var b,v,p=this._events[u],h=arguments.length;if(p.fn){switch(p.once&&this.removeListener(e,p.fn,void 0,!0),h){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,n),!0;case 3:return p.fn.call(p.context,n,r),!0;case 4:return p.fn.call(p.context,n,r,i),!0;case 5:return p.fn.call(p.context,n,r,i,a),!0;case 6:return p.fn.call(p.context,n,r,i,a,l),!0}for(v=1,b=new Array(h-1);v<h;v++)b[v-1]=arguments[v];p.fn.apply(p.context,b)}else{var L,O=p.length;for(v=0;v<O;v++)switch(p[v].once&&this.removeListener(e,p[v].fn,void 0,!0),h){case 1:p[v].fn.call(p[v].context);break;case 2:p[v].fn.call(p[v].context,n);break;case 3:p[v].fn.call(p[v].context,n,r);break;case 4:p[v].fn.call(p[v].context,n,r,i);break;default:if(!b)for(L=1,b=new Array(h-1);L<h;L++)b[L-1]=arguments[L];p[v].fn.apply(p[v].context,b)}}return!0},me.prototype.on=function(e,n,r){return Cn(this,e,n,r,!1)},me.prototype.once=function(e,n,r){return Cn(this,e,n,r,!0)},me.prototype.removeListener=function(e,n,r,i){var a=ge?ge+e:e;if(!this._events[a])return this;if(!n)return gr(this,a),this;var l=this._events[a];if(l.fn)l.fn===n&&(!i||l.once)&&(!r||l.context===r)&&gr(this,a);else{for(var u=0,p=[],h=l.length;u<h;u++)(l[u].fn!==n||i&&!l[u].once||r&&l[u].context!==r)&&p.push(l[u]);p.length?this._events[a]=1===p.length?p[0]:p:gr(this,a)}return this},me.prototype.removeAllListeners=function(e){var n;return e?this._events[n=ge?ge+e:e]&&gr(this,n):(this._events=new Ut,this._eventsCount=0),this},me.prototype.off=me.prototype.removeListener,me.prototype.addListener=me.prototype.on,me.prefixed=ge,me.EventEmitter=me,qr=me;var tt={};et(tt,"ConnectionType",()=>Me),et(tt,"PeerErrorType",()=>ne),et(tt,"BaseConnectionErrorType",()=>br),et(tt,"DataConnectionErrorType",()=>_r),et(tt,"SerializationType",()=>Nt),et(tt,"SocketEventType",()=>Be),et(tt,"ServerMessageType",()=>he);var Hr,Me=function(t){return t.Data="data",t.Media="media",t}(Me||{}),ne=function(t){return t.BrowserIncompatible="browser-incompatible",t.Disconnected="disconnected",t.InvalidID="invalid-id",t.InvalidKey="invalid-key",t.Network="network",t.PeerUnavailable="peer-unavailable",t.SslUnavailable="ssl-unavailable",t.ServerError="server-error",t.SocketError="socket-error",t.SocketClosed="socket-closed",t.UnavailableID="unavailable-id",t.WebRTC="webrtc",t}(ne||{}),br=function(t){return t.NegotiationFailed="negotiation-failed",t.ConnectionClosed="connection-closed",t}(br||{}),_r=function(t){return t.NotOpenYet="not-open-yet",t.MessageToBig="message-too-big",t}(_r||{}),Nt=function(t){return t.Binary="binary",t.BinaryUTF8="binary-utf8",t.JSON="json",t.None="raw",t}(Nt||{}),Be=function(t){return t.Message="message",t.Disconnected="disconnected",t.Error="error",t.Close="close",t}(Be||{}),he=function(t){return t.Heartbeat="HEARTBEAT",t.Candidate="CANDIDATE",t.Offer="OFFER",t.Answer="ANSWER",t.Open="OPEN",t.Error="ERROR",t.IdTaken="ID-TAKEN",t.InvalidKey="INVALID-KEY",t.Leave="LEAVE",t.Expire="EXPIRE",t}(he||{});Hr=JSON.parse('{"name":"peerjs","version":"1.5.1","keywords":["peerjs","webrtc","p2p","rtc"],"description":"PeerJS client","homepage":"https://peerjs.com","bugs":{"url":"https://github.com/peers/peerjs/issues"},"repository":{"type":"git","url":"https://github.com/peers/peerjs"},"license":"MIT","contributors":["Michelle Bu <michelle@michellebu.com>","afrokick <devbyru@gmail.com>","ericz <really.ez@gmail.com>","Jairo <kidandcat@gmail.com>","Jonas Gloning <34194370+jonasgloning@users.noreply.github.com>","Jairo Caro-Accino Viciana <jairo@galax.be>","Carlos Caballero <carlos.caballero.gonzalez@gmail.com>","hc <hheennrryy@gmail.com>","Muhammad Asif <capripio@gmail.com>","PrashoonB <prashoonbhattacharjee@gmail.com>","Harsh Bardhan Mishra <47351025+HarshCasper@users.noreply.github.com>","akotynski <aleksanderkotbury@gmail.com>","lmb <i@lmb.io>","Jairooo <jairocaro@msn.com>","Moritz St\xfcckler <moritz.stueckler@gmail.com>","Simon <crydotsnakegithub@gmail.com>","Denis Lukov <denismassters@gmail.com>","Philipp Hancke <fippo@andyet.net>","Hans Oksendahl <hansoksendahl@gmail.com>","Jess <jessachandler@gmail.com>","khankuan <khankuan@gmail.com>","DUODVK <kurmanov.work@gmail.com>","XiZhao <kwang1imsa@gmail.com>","Matthias Lohr <matthias@lohr.me>","=frank tree <=frnktrb@googlemail.com>","Andre Eckardt <aeckardt@outlook.com>","Chris Cowan <agentme49@gmail.com>","Alex Chuev <alex@chuev.com>","alxnull <alxnull@e.mail.de>","Yemel Jardi <angel.jardi@gmail.com>","Ben Parnell <benjaminparnell.94@gmail.com>","Benny Lichtner <bennlich@gmail.com>","fresheneesz <bitetrudpublic@gmail.com>","bob.barstead@exaptive.com <bob.barstead@exaptive.com>","chandika <chandika@gmail.com>","emersion <contact@emersion.fr>","Christopher Van <cvan@users.noreply.github.com>","eddieherm <edhermoso@gmail.com>","Eduardo Pinho <enet4mikeenet@gmail.com>","Evandro Zanatta <ezanatta@tray.net.br>","Gardner Bickford <gardner@users.noreply.github.com>","Gian Luca <gianluca.cecchi@cynny.com>","PatrickJS <github@gdi2290.com>","jonnyf <github@jonathanfoss.co.uk>","Hizkia Felix <hizkifw@gmail.com>","Hristo Oskov <hristo.oskov@gmail.com>","Isaac Madwed <i.madwed@gmail.com>","Ilya Konanykhin <ilya.konanykhin@gmail.com>","jasonbarry <jasbarry@me.com>","Jonathan Burke <jonathan.burke.1311@googlemail.com>","Josh Hamit <josh.hamit@gmail.com>","Jordan Austin <jrax86@gmail.com>","Joel Wetzell <jwetzell@yahoo.com>","xizhao <kevin.wang@cloudera.com>","Alberto Torres <kungfoobar@gmail.com>","Jonathan Mayol <mayoljonathan@gmail.com>","Jefferson Felix <me@jsfelix.dev>","Rolf Erik Lekang <me@rolflekang.com>","Kevin Mai-Husan Chia <mhchia@users.noreply.github.com>","Pepijn de Vos <pepijndevos@gmail.com>","JooYoung <qkdlql@naver.com>","Tobias Speicher <rootcommander@gmail.com>","Steve Blaurock <sblaurock@gmail.com>","Kyrylo Shegeda <shegeda@ualberta.ca>","Diwank Singh Tomer <singh@diwank.name>","So\u0308ren Balko <Soeren.Balko@gmail.com>","Arpit Solanki <solankiarpit1997@gmail.com>","Yuki Ito <yuki@gnnk.net>","Artur Zayats <zag2art@gmail.com>"],"funding":{"type":"opencollective","url":"https://opencollective.com/peer"},"collective":{"type":"opencollective","url":"https://opencollective.com/peer"},"files":["dist/*"],"sideEffects":["lib/global.ts","lib/supports.ts"],"main":"dist/bundler.cjs","module":"dist/bundler.mjs","browser-minified":"dist/peerjs.min.js","browser-unminified":"dist/peerjs.js","browser-minified-cbor":"dist/serializer.cbor.mjs","browser-minified-msgpack":"dist/serializer.msgpack.mjs","types":"dist/types.d.ts","engines":{"node":">= 14"},"targets":{"types":{"source":"lib/exports.ts"},"main":{"source":"lib/exports.ts","sourceMap":{"inlineSources":true}},"module":{"source":"lib/exports.ts","includeNodeModules":["eventemitter3"],"sourceMap":{"inlineSources":true}},"browser-minified":{"context":"browser","outputFormat":"global","optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-unminified":{"context":"browser","outputFormat":"global","optimize":false,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-minified-cbor":{"context":"browser","outputFormat":"esmodule","isLibrary":true,"optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 102, safari >= 15"},"source":"lib/dataconnection/StreamConnection/Cbor.ts"},"browser-minified-msgpack":{"context":"browser","outputFormat":"esmodule","isLibrary":true,"optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 102, safari >= 15"},"source":"lib/dataconnection/StreamConnection/MsgPack.ts"}},"scripts":{"contributors":"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\"chore(contributors): update and sort contributors list\\"","check":"tsc --noEmit && tsc -p e2e/tsconfig.json --noEmit","watch":"parcel watch","build":"rm -rf dist && parcel build","prepublishOnly":"npm run build","test":"jest","test:watch":"jest --watch","coverage":"jest --coverage --collectCoverageFrom=\\"./lib/**\\"","format":"prettier --write .","format:check":"prettier --check .","semantic-release":"semantic-release","e2e":"wdio run e2e/wdio.local.conf.ts","e2e:bstack":"wdio run e2e/wdio.bstack.conf.ts"},"devDependencies":{"@parcel/config-default":"^2.9.3","@parcel/packager-ts":"^2.9.3","@parcel/transformer-typescript-tsc":"^2.9.3","@parcel/transformer-typescript-types":"^2.9.3","@semantic-release/changelog":"^6.0.1","@semantic-release/git":"^10.0.1","@swc/core":"^1.3.27","@swc/jest":"^0.2.24","@types/jasmine":"^4.3.4","@wdio/browserstack-service":"^8.11.2","@wdio/cli":"^8.11.2","@wdio/globals":"^8.11.2","@wdio/jasmine-framework":"^8.11.2","@wdio/local-runner":"^8.11.2","@wdio/spec-reporter":"^8.11.2","@wdio/types":"^8.10.4","http-server":"^14.1.1","jest":"^29.3.1","jest-environment-jsdom":"^29.3.1","mock-socket":"^9.0.0","parcel":"^2.9.3","prettier":"^3.0.0","semantic-release":"^21.0.0","ts-node":"^10.9.1","typescript":"^5.0.0","wdio-geckodriver-service":"^5.0.1"},"dependencies":{"@msgpack/msgpack":"^2.8.0","cbor-x":"^1.5.3","eventemitter3":"^4.0.7","peerjs-js-binarypack":"^2.0.0","webrtc-adapter":"^8.0.0"},"alias":{"process":false,"buffer":false}}');class si extends qr.EventEmitter{constructor(e,n,r,i,a,l=5e3){super(),this.pingInterval=l,this._disconnected=!0,this._messagesQueue=[],this._baseUrl=(e?"wss://":"ws://")+n+":"+r+i+"peerjs?key="+a}start(e,n){this._id=e,this._socket||!this._disconnected||(this._socket=new WebSocket(`${this._baseUrl}&id=${e}&token=${n}&version=`+Hr.version),this._disconnected=!1,this._socket.onmessage=i=>{let a;try{a=JSON.parse(i.data),w.log("Server message received:",a)}catch{return void w.log("Invalid server message",i.data)}this.emit(Be.Message,a)},this._socket.onclose=i=>{this._disconnected||(w.log("Socket closed.",i),this._cleanup(),this._disconnected=!0,this.emit(Be.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),w.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen())return void w.log("Cannot send heartbeat, because socket closed");const e=JSON.stringify({type:he.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&1===this._socket.readyState}_sendQueuedMessages(){const e=[...this._messagesQueue];this._messagesQueue=[];for(const n of e)this.send(n)}send(e){if(this._disconnected)return;if(!this._id)return void this._messagesQueue.push(e);if(!e.type)return void this.emit(Be.Error,"Invalid message");if(!this._wsOpen())return;const n=JSON.stringify(e);this._socket.send(n)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class vn{constructor(e){this.connection=e}startConnection(e){const n=this._startPeerConnection();if(this.connection.peerConnection=n,this.connection.type===Me.Media&&e._stream&&this._addTracksToConnection(e._stream,n),e.originator){const r=this.connection,a=n.createDataChannel(r.label,{ordered:!!e.reliable});r._initializeDataChannel(a),this._makeOffer()}else this.handleSDP("OFFER",e.sdp)}_startPeerConnection(){w.log("Creating RTCPeerConnection.");const e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e}_setupListeners(e){const n=this.connection.peer,r=this.connection.connectionId,i=this.connection.type,a=this.connection.provider;w.log("Listening for ICE candidates."),e.onicecandidate=l=>{!l.candidate||!l.candidate.candidate||(w.log(`Received ICE candidates for ${n}:`,l.candidate),a.socket.send({type:he.Candidate,payload:{candidate:l.candidate,type:i,connectionId:r},dst:n}))},e.oniceconnectionstatechange=()=>{switch(e.iceConnectionState){case"failed":w.log("iceConnectionState is failed, closing connections to "+n),this.connection.emitError(br.NegotiationFailed,"Negotiation of connection to "+n+" failed."),this.connection.close();break;case"closed":w.log("iceConnectionState is closed, closing connections to "+n),this.connection.emitError(br.ConnectionClosed,"Connection to "+n+" closed."),this.connection.close();break;case"disconnected":w.log("iceConnectionState changed to disconnected on the connection with "+n);break;case"completed":e.onicecandidate=()=>{}}this.connection.emit("iceStateChanged",e.iceConnectionState)},w.log("Listening for data channel"),e.ondatachannel=l=>{w.log("Received data channel");const u=l.channel;a.getConnection(n,r)._initializeDataChannel(u)},w.log("Listening for remote stream"),e.ontrack=l=>{w.log("Received remote stream");const u=l.streams[0],p=a.getConnection(n,r);p.type===Me.Media&&this._addStreamToMediaConnection(u,p)}}cleanup(){w.log("Cleaning up PeerConnection to "+this.connection.peer);const e=this.connection.peerConnection;if(!e)return;this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=()=>{};let r=!1;const i=this.connection.dataChannel;i&&(r=!!i.readyState&&"closed"!==i.readyState),("closed"!==e.signalingState||r)&&e.close()}_makeOffer(){var e=this;return(0,H.Z)(function*(){const n=e.connection.peerConnection,r=e.connection.provider;try{const i=yield n.createOffer(e.connection.options.constraints);w.log("Created offer."),e.connection.options.sdpTransform&&"function"==typeof e.connection.options.sdpTransform&&(i.sdp=e.connection.options.sdpTransform(i.sdp)||i.sdp);try{yield n.setLocalDescription(i),w.log("Set localDescription:",i,`for:${e.connection.peer}`);let a={sdp:i,type:e.connection.type,connectionId:e.connection.connectionId,metadata:e.connection.metadata};if(e.connection.type===Me.Data){const l=e.connection;a={...a,label:l.label,reliable:l.reliable,serialization:l.serialization}}r.socket.send({type:he.Offer,payload:a,dst:e.connection.peer})}catch(a){"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=a&&(r.emitError(ne.WebRTC,a),w.log("Failed to setLocalDescription, ",a))}}catch(i){r.emitError(ne.WebRTC,i),w.log("Failed to createOffer, ",i)}})()}_makeAnswer(){var e=this;return(0,H.Z)(function*(){const n=e.connection.peerConnection,r=e.connection.provider;try{const i=yield n.createAnswer();w.log("Created answer."),e.connection.options.sdpTransform&&"function"==typeof e.connection.options.sdpTransform&&(i.sdp=e.connection.options.sdpTransform(i.sdp)||i.sdp);try{yield n.setLocalDescription(i),w.log("Set localDescription:",i,`for:${e.connection.peer}`),r.socket.send({type:he.Answer,payload:{sdp:i,type:e.connection.type,connectionId:e.connection.connectionId},dst:e.connection.peer})}catch(a){r.emitError(ne.WebRTC,a),w.log("Failed to setLocalDescription, ",a)}}catch(i){r.emitError(ne.WebRTC,i),w.log("Failed to create answer, ",i)}})()}handleSDP(e,n){var r=this;return(0,H.Z)(function*(){n=new RTCSessionDescription(n);const i=r.connection.peerConnection,a=r.connection.provider;w.log("Setting remote description",n);const l=r;try{yield i.setRemoteDescription(n),w.log(`Set remoteDescription:${e} for:${r.connection.peer}`),"OFFER"===e&&(yield l._makeAnswer())}catch(u){a.emitError(ne.WebRTC,u),w.log("Failed to setRemoteDescription, ",u)}})()}handleCandidate(e){var n=this;return(0,H.Z)(function*(){w.log("handleCandidate:",e);try{yield n.connection.peerConnection.addIceCandidate(e),w.log(`Added ICE candidate for:${n.connection.peer}`)}catch(r){n.connection.provider.emitError(ne.WebRTC,r),w.log("Failed to handleCandidate, ",r)}})()}_addTracksToConnection(e,n){if(w.log(`add tracks from stream ${e.id} to peer connection`),!n.addTrack)return w.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(r=>{n.addTrack(r,e)})}_addStreamToMediaConnection(e,n){w.log(`add stream ${e.id} to media connection ${n.connectionId}`),n.addStream(e)}}class Sn extends qr.EventEmitter{emitError(e,n){w.error("Error:",n),this.emit("error",new oi(`${e}`,n))}}class oi extends Error{constructor(e,n){"string"==typeof n?super(n):(super(),Object.assign(this,n)),this.type=e}}class kn extends Sn{get open(){return this._open}constructor(e,n,r){super(),this.peer=e,this.provider=n,this.options=r,this._open=!1,this.metadata=r.metadata}}class jt extends kn{get type(){return Me.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(e,n,r){super(e,n,r),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||jt.ID_PREFIX+_e.randomToken(),this._negotiator=new vn(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{w.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{w.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(e){w.log("Receiving stream",e),this._remoteStream=e,super.emit("stream",e)}handleMessage(e){const n=e.type,r=e.payload;switch(e.type){case he.Answer:this._negotiator.handleSDP(n,r.sdp),this._open=!0;break;case he.Candidate:this._negotiator.handleCandidate(r.candidate);break;default:w.warn(`Unrecognized message type:${n} from peer:${this.peer}`)}}answer(e,n={}){if(this._localStream)return void w.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");this._localStream=e,n&&n.sdpTransform&&(this.options.sdpTransform=n.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:e});const r=this.provider._getMessages(this.connectionId);for(const i of r)this.handleMessage(i);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}}jt.ID_PREFIX="mc_";class ai{constructor(e){this._options=e}_buildRequest(e){const n=this._options.secure?"https":"http",{host:r,port:i,path:a,key:l}=this._options,u=new URL(`${n}://${r}:${i}${a}${l}/${e}`);return u.searchParams.set("ts",`${Date.now()}${Math.random()}`),u.searchParams.set("version",Hr.version),fetch(u.href,{referrerPolicy:this._options.referrerPolicy})}retrieveId(){var e=this;return(0,H.Z)(function*(){try{const n=yield e._buildRequest("id");if(200!==n.status)throw new Error(`Error. Status:${n.status}`);return n.text()}catch(n){w.error("Error retrieving ID",n);let r="";throw"/"===e._options.path&&e._options.host!==_e.CLOUD_HOST&&(r=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+r)}})()}listAllPeers(){var e=this;return(0,H.Z)(function*(){try{const n=yield e._buildRequest("peers");if(200!==n.status){if(401===n.status){let r="";throw r=e._options.host===_e.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+r)}throw new Error(`Error. Status:${n.status}`)}return n.json()}catch(n){throw w.error("Error retrieving list peers",n),new Error("Could not get list peers from the server."+n)}})()}}class rt extends kn{get type(){return Me.Data}constructor(e,n,r){super(e,n,r),this.connectionId=this.options.connectionId||rt.ID_PREFIX+_n(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new vn(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{w.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=n=>{w.log(`DC#${this.connectionId} dc onmessage:`,n.data)},this.dataChannel.onclose=()=>{w.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(e){e?.flush?this.send({__peerData:{type:"close"}}):(this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close")))}send(e,n=!1){if(this.open)return this._send(e,n);this.emitError(_r.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.")}handleMessage(e){var n=this;return(0,H.Z)(function*(){const r=e.payload;switch(e.type){case he.Answer:yield n._negotiator.handleSDP(e.type,r.sdp);break;case he.Candidate:yield n._negotiator.handleCandidate(r.candidate);break;default:w.warn("Unrecognized message type:",e.type,"from peer:",n.peer)}})()}}(Kr=rt).ID_PREFIX="dc_",Kr.MAX_BUFFERED_AMOUNT=8388608;class Wr extends rt{get bufferSize(){return this._bufferSize}_initializeDataChannel(e){super._initializeDataChannel(e),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",n=>this._handleDataMessage(n))}_bufferedSend(e){(this._buffering||!this._trySend(e))&&(this._buffer.push(e),this._bufferSize=this._buffer.length)}_trySend(e){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>rt.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(n){return w.error(`DC#:${this.connectionId} Error when sending:`,n),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){this.open&&0!==this._buffer.length&&this._trySend(this._buffer[0])&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(e){e?.flush?this.send({__peerData:{type:"close"}}):(this._buffer=[],this._bufferSize=0,super.close())}constructor(...e){super(...e),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class Yr extends Wr{close(e){super.close(e),this._chunkedData={}}constructor(e,n,r){super(e,n,r),this.chunker=new bn,this.serialization=Nt.Binary,this._chunkedData={}}_handleDataMessage({data:e}){const n=be(e),r=n.__peerData;if(r)return"close"===r.type?void this.close():void this._handleChunk(n);this.emit("data",n)}_handleChunk(e){const n=e.__peerData,r=this._chunkedData[n]||{data:[],count:0,total:e.total};if(r.data[e.n]=new Uint8Array(e.data),r.count++,this._chunkedData[n]=r,r.total===r.count){delete this._chunkedData[n];const i=function Zn(t){let e=0;for(const i of t)e+=i.byteLength;const n=new Uint8Array(e);let r=0;for(const i of t)n.set(i,r),r+=i.byteLength;return n}(r.data);this._handleDataMessage({data:i})}}_send(e,n){if(e instanceof Blob)return e.arrayBuffer().then(i=>{this._send(i,n)});const r=it(e);!n&&r.byteLength>this.chunker.chunkedMTU?this._sendChunks(r):this._bufferedSend(r)}_sendChunks(e){const n=this.chunker.chunk(e);w.log(`DC#${this.connectionId} Try to send ${n.length} chunks...`);for(const r of n)this.send(r,!0)}}class ci extends Wr{_handleDataMessage({data:e}){super.emit("data",e)}_send(e,n){this._bufferedSend(e)}constructor(...e){super(...e),this.serialization=Nt.None}}class fi extends Wr{_handleDataMessage({data:e}){const n=this.parse(this.decoder.decode(e)),r=n.__peerData;r&&"close"===r.type?this.close():this.emit("data",n)}_send(e,n){const r=this.encoder.encode(this.stringify(e));r.byteLength>=_e.chunkedMTU?this.emitError(_r.MessageToBig,"Message too big for JSON channel"):this._bufferedSend(r)}constructor(...e){super(...e),this.serialization=Nt.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}class xr extends Sn{get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const e=Object.create(null);for(const[n,r]of this._connections)e[n]=r;return e}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(e,n){let r;super(),this._serializers={raw:ci,json:fi,binary:Yr,"binary-utf8":Yr,default:Yr},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map,e&&e.constructor==Object?n=e:e&&(r=e.toString()),n={debug:0,host:_e.CLOUD_HOST,port:_e.CLOUD_PORT,path:"/",key:xr.DEFAULT_KEY,token:_e.randomToken(),config:_e.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...n},this._options=n,this._serializers={...this._serializers,...this.options.serializers},"/"===this._options.host&&(this._options.host=window.location.hostname),this._options.path&&("/"!==this._options.path[0]&&(this._options.path="/"+this._options.path),"/"!==this._options.path[this._options.path.length-1]&&(this._options.path+="/")),void 0===this._options.secure&&this._options.host!==_e.CLOUD_HOST?this._options.secure=_e.isSecure():this._options.host==_e.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&w.setLogFunction(this._options.logFunction),w.logLevel=this._options.debug||0,this._api=new ai(n),this._socket=this._createServerConnection(),_e.supports.audioVideo||_e.supports.data?!r||_e.validateId(r)?r?this._initialize(r):this._api.retrieveId().then(i=>this._initialize(i)).catch(i=>this._abort(ne.ServerError,i)):this._delayedAbort(ne.InvalidID,`ID "${r}" is invalid`):this._delayedAbort(ne.BrowserIncompatible,"The current browser does not support WebRTC")}_createServerConnection(){const e=new si(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(Be.Message,n=>{this._handleMessage(n)}),e.on(Be.Error,n=>{this._abort(ne.SocketError,n)}),e.on(Be.Disconnected,()=>{this.disconnected||(this.emitError(ne.Network,"Lost connection to server."),this.disconnect())}),e.on(Be.Close,()=>{this.disconnected||this._abort(ne.SocketClosed,"Underlying socket is already closed.")}),e}_initialize(e){this._id=e,this.socket.start(e,this._options.token)}_handleMessage(e){const n=e.type,r=e.payload,i=e.src;switch(n){case he.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case he.Error:this._abort(ne.ServerError,r.msg);break;case he.IdTaken:this._abort(ne.UnavailableID,`ID "${this.id}" is taken`);break;case he.InvalidKey:this._abort(ne.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case he.Leave:w.log(`Received leave message from ${i}`),this._cleanupPeer(i),this._connections.delete(i);break;case he.Expire:this.emitError(ne.PeerUnavailable,`Could not connect to peer ${i}`);break;case he.Offer:{const a=r.connectionId;let l=this.getConnection(i,a);if(l&&(l.close(),w.warn(`Offer received for existing Connection ID:${a}`)),r.type===Me.Media){const p=new jt(i,this,{connectionId:a,_payload:r,metadata:r.metadata});l=p,this._addConnection(i,l),this.emit("call",p)}else{if(r.type!==Me.Data)return void w.warn(`Received malformed connection type:${r.type}`);{const p=new this._serializers[r.serialization](i,this,{connectionId:a,_payload:r,metadata:r.metadata,label:r.label,serialization:r.serialization,reliable:r.reliable});l=p,this._addConnection(i,l),this.emit("connection",p)}}const u=this._getMessages(a);for(const p of u)l.handleMessage(p);break}default:{if(!r)return void w.warn(`You received a malformed message from ${i} of type ${n}`);const a=r.connectionId,l=this.getConnection(i,a);l&&l.peerConnection?l.handleMessage(e):a?this._storeMessage(a,e):w.warn("You received an unrecognized message:",e);break}}}_storeMessage(e,n){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(n)}_getMessages(e){const n=this._lostMessages.get(e);return n?(this._lostMessages.delete(e),n):[]}connect(e,n={}){if(n={serialization:"default",...n},this.disconnected)return w.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError(ne.Disconnected,"Cannot connect to new Peer after disconnecting from server.");const r=new this._serializers[n.serialization](e,this,n);return this._addConnection(e,r),r}call(e,n,r={}){if(this.disconnected)return w.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError(ne.Disconnected,"Cannot connect to new Peer after disconnecting from server.");if(!n)return void w.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");const i=new jt(e,this,{...r,_stream:n});return this._addConnection(e,i),i}_addConnection(e,n){w.log(`add connection ${n.type}:${n.connectionId} to peerId:${e}`),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(n)}_removeConnection(e){const n=this._connections.get(e.peer);if(n){const r=n.indexOf(e);-1!==r&&n.splice(r,1)}this._lostMessages.delete(e.connectionId)}getConnection(e,n){const r=this._connections.get(e);if(!r)return null;for(const i of r)if(i.connectionId===n)return i;return null}_delayedAbort(e,n){setTimeout(()=>{this._abort(e,n)},0)}_abort(e,n){w.error("Aborting!"),this.emitError(e,n),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(w.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const e of this._connections.keys())this._cleanupPeer(e),this._connections.delete(e);this.socket.removeAllListeners()}_cleanupPeer(e){const n=this._connections.get(e);if(n)for(const r of n)r.close()}disconnect(){if(this.disconnected)return;const e=this.id;w.log(`Disconnect peer with ID:${e}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit("disconnected",e)}reconnect(){if(this.disconnected&&!this.destroyed)w.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`);w.error("In a hurry? We're still trying to make the initial connection!")}}listAllPeers(e=(n=>{})){this._api.listAllPeers().then(n=>e(n)).catch(n=>this._abort(ne.ServerError,n))}}xr.DEFAULT_KEY="peerjs",Symbol.for(null);var di=xr},5887:(vr,k,m)=>{m.d(k,{io:()=>oe});var y={};m.r(y),m.d(y,{Decoder:()=>X,Encoder:()=>Xe,PacketType:()=>F,protocol:()=>Ne});const S=Object.create(null);S.open="0",S.close="1",S.ping="2",S.pong="3",S.message="4",S.upgrade="5",S.noop="6";const A=Object.create(null);Object.keys(S).forEach(c=>{A[S[c]]=c});const j={type:"error",data:"parser error"},H="function"==typeof Blob||typeof Blob<"u"&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),ee="function"==typeof ArrayBuffer,de=c=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(c):c&&c.buffer instanceof ArrayBuffer,ie=({type:c,data:s},o,f)=>H&&s instanceof Blob?o?f(s):ue(s,f):ee&&(s instanceof ArrayBuffer||de(s))?o?f(s):ue(new Blob([s]),f):f(S[c]+(s||"")),ue=(c,s)=>{const o=new FileReader;return o.onload=function(){const f=o.result.split(",")[1];s("b"+(f||""))},o.readAsDataURL(c)};function pe(c){return c instanceof Uint8Array?c:c instanceof ArrayBuffer?new Uint8Array(c):new Uint8Array(c.buffer,c.byteOffset,c.byteLength)}let be;const ze=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let c=0;c<64;c++)ze["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(c)]=c;const st="function"==typeof ArrayBuffer,Se=(c,s)=>{if("string"!=typeof c)return{type:"message",data:Kt(c,s)};const o=c.charAt(0);return"b"===o?{type:"message",data:kr(c.substring(1),s)}:A[o]?c.length>1?{type:A[o],data:c.substring(1)}:{type:A[o]}:j},kr=(c,s)=>{if(st){const o=(c=>{let f,T,M,q,K,s=.75*c.length,o=c.length,g=0;"="===c[c.length-1]&&(s--,"="===c[c.length-2]&&s--);const N=new ArrayBuffer(s),ve=new Uint8Array(N);for(f=0;f<o;f+=4)T=ze[c.charCodeAt(f)],M=ze[c.charCodeAt(f+1)],q=ze[c.charCodeAt(f+2)],K=ze[c.charCodeAt(f+3)],ve[g++]=T<<2|M>>4,ve[g++]=(15&M)<<4|q>>2,ve[g++]=(3&q)<<6|63&K;return N})(c);return Kt(o,s)}return{base64:!0,data:c}},Kt=(c,s)=>"blob"===s?c instanceof Blob?c:new Blob([c]):c instanceof ArrayBuffer?c:c.buffer,bt=String.fromCharCode(30);let ot;function Ue(c){return c.reduce((s,o)=>s+o.length,0)}function Ve(c,s){if(c[0].length===s)return c.shift();const o=new Uint8Array(s);let f=0;for(let g=0;g<s;g++)o[g]=c[0][f++],f===c[0].length&&(c.shift(),f=0);return c.length&&f<c[0].length&&(c[0]=c[0].slice(f)),o}function re(c){if(c)return function Ht(c){for(var s in re.prototype)c[s]=re.prototype[s];return c}(c)}re.prototype.on=re.prototype.addEventListener=function(c,s){return this._callbacks=this._callbacks||{},(this._callbacks["$"+c]=this._callbacks["$"+c]||[]).push(s),this},re.prototype.once=function(c,s){function o(){this.off(c,o),s.apply(this,arguments)}return o.fn=s,this.on(c,o),this},re.prototype.off=re.prototype.removeListener=re.prototype.removeAllListeners=re.prototype.removeEventListener=function(c,s){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var o=this._callbacks["$"+c];if(!o)return this;if(1==arguments.length)return delete this._callbacks["$"+c],this;for(var f,g=0;g<o.length;g++)if((f=o[g])===s||f.fn===s){o.splice(g,1);break}return 0===o.length&&delete this._callbacks["$"+c],this},re.prototype.emitReserved=re.prototype.emit=function(c){this._callbacks=this._callbacks||{};for(var s=new Array(arguments.length-1),o=this._callbacks["$"+c],f=1;f<arguments.length;f++)s[f-1]=arguments[f];if(o){f=0;for(var g=(o=o.slice(0)).length;f<g;++f)o[f].apply(this,s)}return this},re.prototype.listeners=function(c){return this._callbacks=this._callbacks||{},this._callbacks["$"+c]||[]},re.prototype.hasListeners=function(c){return!!this.listeners(c).length};const ye=typeof self<"u"?self:typeof window<"u"?window:Function("return this")();function Ct(c,...s){return s.reduce((o,f)=>(c.hasOwnProperty(f)&&(o[f]=c[f]),o),{})}const Wt=ye.setTimeout,Yt=ye.clearTimeout;function Ge(c,s){s.useNativeTimers?(c.setTimeoutFn=Wt.bind(ye),c.clearTimeoutFn=Yt.bind(ye)):(c.setTimeoutFn=ye.setTimeout.bind(ye),c.clearTimeoutFn=ye.clearTimeout.bind(ye))}function vt(c){return"string"==typeof c?function Zt(c){let s=0,o=0;for(let f=0,g=c.length;f<g;f++)s=c.charCodeAt(f),s<128?o+=1:s<2048?o+=2:s<55296||s>=57344?o+=3:(f++,o+=4);return o}(c):Math.ceil(1.33*(c.byteLength||c.size))}class er extends Error{constructor(s,o,f){super(s),this.description=o,this.context=f,this.type="TransportError"}}class Ke extends re{constructor(s){super(),this.writable=!1,Ge(this,s),this.opts=s,this.query=s.query,this.socket=s.socket}onError(s,o,f){return super.emitReserved("error",new er(s,o,f)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this}send(s){"open"===this.readyState&&this.write(s)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(s){const o=Se(s,this.socket.binaryType);this.onPacket(o)}onPacket(s){super.emitReserved("packet",s)}onClose(s){this.readyState="closed",super.emitReserved("close",s)}pause(s){}createUri(s,o={}){return s+"://"+this._hostname()+this._port()+this.opts.path+this._query(o)}_hostname(){const s=this.opts.hostname;return-1===s.indexOf(":")?s:"["+s+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(s){const o=function Qt(c){let s="";for(let o in c)c.hasOwnProperty(o)&&(s.length&&(s+="&"),s+=encodeURIComponent(o)+"="+encodeURIComponent(c[o]));return s}(s);return o.length?"?"+o:""}}const St="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Je=64,kt={};let Rt,Tt=0,ke=0;function Et(c){let s="";do{s=St[c%Je]+s,c=Math.floor(c/Je)}while(c>0);return s}function Pt(){const c=Et(+new Date);return c!==Rt?(Tt=0,Rt=c):c+"."+Et(Tt++)}for(;ke<Je;ke++)kt[St[ke]]=ke;let At=!1;try{At=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const tr=At;function Ot(c){const s=c.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!s||tr))return new XMLHttpRequest}catch{}if(!s)try{return new(ye[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch{}}function rr(){}const nr=null!=new Ot({xdomain:!1}).responseType;let qe=(()=>{class c extends re{constructor(o,f){super(),Ge(this,f),this.opts=f,this.method=f.method||"GET",this.uri=o,this.data=void 0!==f.data?f.data:null,this.create()}create(){var o;const f=Ct(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");f.xdomain=!!this.opts.xd;const g=this.xhr=new Ot(f);try{g.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){g.setDisableHeaderCheck&&g.setDisableHeaderCheck(!0);for(let T in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(T)&&g.setRequestHeader(T,this.opts.extraHeaders[T])}}catch{}if("POST"===this.method)try{g.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{g.setRequestHeader("Accept","*/*")}catch{}null===(o=this.opts.cookieJar)||void 0===o||o.addCookies(g),"withCredentials"in g&&(g.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(g.timeout=this.opts.requestTimeout),g.onreadystatechange=()=>{var T;3===g.readyState&&(null===(T=this.opts.cookieJar)||void 0===T||T.parseCookies(g)),4===g.readyState&&(200===g.status||1223===g.status?this.onLoad():this.setTimeoutFn(()=>{this.onError("number"==typeof g.status?g.status:0)},0))},g.send(this.data)}catch(T){return void this.setTimeoutFn(()=>{this.onError(T)},0)}typeof document<"u"&&(this.index=c.requestsCount++,c.requests[this.index]=this)}onError(o){this.emitReserved("error",o,this.xhr),this.cleanup(!0)}cleanup(o){if(!(typeof this.xhr>"u"||null===this.xhr)){if(this.xhr.onreadystatechange=rr,o)try{this.xhr.abort()}catch{}typeof document<"u"&&delete c.requests[this.index],this.xhr=null}}onLoad(){const o=this.xhr.responseText;null!==o&&(this.emitReserved("data",o),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}return c.requestsCount=0,c.requests={},c})();function It(){for(let c in qe.requests)qe.requests.hasOwnProperty(c)&&qe.requests[c].abort()}typeof document<"u"&&("function"==typeof attachEvent?attachEvent("onunload",It):"function"==typeof addEventListener&&addEventListener("onpagehide"in ye?"pagehide":"unload",It,!1));const Ie="function"==typeof Promise&&"function"==typeof Promise.resolve?s=>Promise.resolve().then(s):(s,o)=>o(s,0),De=ye.WebSocket||ye.MozWebSocket,We=typeof navigator<"u"&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),ct={websocket:class Dt extends Ke{constructor(s){super(s),this.supportsBinary=!s.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const s=this.uri(),o=this.opts.protocols,f=We?{}:Ct(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(f.headers=this.opts.extraHeaders);try{this.ws=We?new De(s,o,f):o?new De(s,o):new De(s)}catch(g){return this.emitReserved("error",g)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=s=>this.onClose({description:"websocket connection closed",context:s}),this.ws.onmessage=s=>this.onData(s.data),this.ws.onerror=s=>this.onError("websocket error",s)}write(s){this.writable=!1;for(let o=0;o<s.length;o++){const g=o===s.length-1;ie(s[o],this.supportsBinary,T=>{try{this.ws.send(T)}catch{}g&&Ie(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){const s=this.opts.secure?"wss":"ws",o=this.query||{};return this.opts.timestampRequests&&(o[this.opts.timestampParam]=Pt()),this.supportsBinary||(o.b64=1),this.createUri(s,o)}check(){return!!De}},webtransport:class wt extends Ke{get name(){return"webtransport"}doOpen(){"function"==typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(s=>{this.onError("webtransport error",s)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(s=>{const o=function qt(c,s){ot||(ot=new TextDecoder);const o=[];let f=0,g=-1,T=!1;return new TransformStream({transform(M,q){for(o.push(M);;){if(0===f){if(Ue(o)<1)break;const K=Ve(o,1);T=128==(128&K[0]),g=127&K[0],f=g<126?3:126===g?1:2}else if(1===f){if(Ue(o)<2)break;const K=Ve(o,2);g=new DataView(K.buffer,K.byteOffset,K.length).getUint16(0),f=3}else if(2===f){if(Ue(o)<8)break;const K=Ve(o,8),N=new DataView(K.buffer,K.byteOffset,K.length),ve=N.getUint32(0);if(ve>Math.pow(2,21)-1){q.enqueue(j);break}g=ve*Math.pow(2,32)+N.getUint32(4),f=3}else{if(Ue(o)<g)break;const K=Ve(o,g);q.enqueue(Se(T?K:ot.decode(K),s)),f=0}if(0===g||g>c){q.enqueue(j);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),f=s.readable.pipeThrough(o).getReader(),g=function Jt(){return new TransformStream({transform(c,s){!function it(c,s){H&&c.data instanceof Blob?c.data.arrayBuffer().then(pe).then(s):ee&&(c.data instanceof ArrayBuffer||de(c.data))?s(pe(c.data)):ie(c,!1,o=>{be||(be=new TextEncoder),s(be.encode(o))})}(c,o=>{const f=o.length;let g;if(f<126)g=new Uint8Array(1),new DataView(g.buffer).setUint8(0,f);else if(f<65536){g=new Uint8Array(3);const T=new DataView(g.buffer);T.setUint8(0,126),T.setUint16(1,f)}else{g=new Uint8Array(9);const T=new DataView(g.buffer);T.setUint8(0,127),T.setBigUint64(1,BigInt(f))}c.data&&"string"!=typeof c.data&&(g[0]|=128),s.enqueue(g),s.enqueue(o)})}})}();g.readable.pipeTo(s.writable),this.writer=g.writable.getWriter();const T=()=>{f.read().then(({done:q,value:K})=>{q||(this.onPacket(K),T())}).catch(q=>{})};T();const M={type:"open"};this.query.sid&&(M.data=`{"sid":"${this.query.sid}"}`),this.writer.write(M).then(()=>this.onOpen())})}))}write(s){this.writable=!1;for(let o=0;o<s.length;o++){const g=o===s.length-1;this.writer.write(s[o]).then(()=>{g&&Ie(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var s;null===(s=this.transport)||void 0===s||s.close()}},polling:class ir extends Ke{constructor(s){if(super(s),this.polling=!1,typeof location<"u"){const f="https:"===location.protocol;let g=location.port;g||(g=f?"443":"80"),this.xd=typeof location<"u"&&s.hostname!==location.hostname||g!==s.port}this.supportsBinary=nr&&!(s&&s.forceBase64),this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(s){this.readyState="pausing";const o=()=>{this.readyState="paused",s()};if(this.polling||!this.writable){let f=0;this.polling&&(f++,this.once("pollComplete",function(){--f||o()})),this.writable||(f++,this.once("drain",function(){--f||o()}))}else o()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(s){((c,s)=>{const o=c.split(bt),f=[];for(let g=0;g<o.length;g++){const T=Se(o[g],s);if(f.push(T),"error"===T.type)break}return f})(s,this.socket.binaryType).forEach(f=>{if("opening"===this.readyState&&"open"===f.type&&this.onOpen(),"close"===f.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(f)}),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const s=()=>{this.write([{type:"close"}])};"open"===this.readyState?s():this.once("open",s)}write(s){this.writable=!1,((c,s)=>{const o=c.length,f=new Array(o);let g=0;c.forEach((T,M)=>{ie(T,!1,q=>{f[M]=q,++g===o&&s(f.join(bt))})})})(s,o=>{this.doWrite(o,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const s=this.opts.secure?"https":"http",o=this.query||{};return!1!==this.opts.timestampRequests&&(o[this.opts.timestampParam]=Pt()),!this.supportsBinary&&!o.sid&&(o.b64=1),this.createUri(s,o)}request(s={}){return Object.assign(s,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new qe(this.uri(),s)}doWrite(s,o){const f=this.request({method:"POST",data:s});f.on("success",o),f.on("error",(g,T)=>{this.onError("xhr post error",g,T)})}doPoll(){const s=this.request();s.on("data",this.onData.bind(this)),s.on("error",(o,f)=>{this.onError("xhr poll error",o,f)}),this.pollXhr=s}}},ft=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Ar=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function sr(c){if(c.length>2e3)throw"URI too long";const s=c,o=c.indexOf("["),f=c.indexOf("]");-1!=o&&-1!=f&&(c=c.substring(0,o)+c.substring(o,f).replace(/:/g,";")+c.substring(f,c.length));let g=ft.exec(c||""),T={},M=14;for(;M--;)T[Ar[M]]=g[M]||"";return-1!=o&&-1!=f&&(T.source=s,T.host=T.host.substring(1,T.host.length-1).replace(/;/g,":"),T.authority=T.authority.replace("[","").replace("]","").replace(/;/g,":"),T.ipv6uri=!0),T.pathNames=function or(c,s){const f=s.replace(/\/{2,9}/g,"/").split("/");return("/"==s.slice(0,1)||0===s.length)&&f.splice(0,1),"/"==s.slice(-1)&&f.splice(f.length-1,1),f}(0,T.path),T.queryKey=function lt(c,s){const o={};return s.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(f,g,T){g&&(o[g]=T)}),o}(0,T.query),T}let ar=(()=>{class c extends re{constructor(o,f={}){super(),this.binaryType="arraybuffer",this.writeBuffer=[],o&&"object"==typeof o&&(f=o,o=null),o?(o=sr(o),f.hostname=o.host,f.secure="https"===o.protocol||"wss"===o.protocol,f.port=o.port,o.query&&(f.query=o.query)):f.host&&(f.hostname=sr(f.host).host),Ge(this,f),this.secure=null!=f.secure?f.secure:typeof location<"u"&&"https:"===location.protocol,f.hostname&&!f.port&&(f.port=this.secure?"443":"80"),this.hostname=f.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=f.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=f.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},f),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function Rr(c){let s={},o=c.split("&");for(let f=0,g=o.length;f<g;f++){let T=o[f].split("=");s[decodeURIComponent(T[0])]=decodeURIComponent(T[1])}return s}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(o){const f=Object.assign({},this.opts.query);f.EIO=4,f.transport=o,this.id&&(f.sid=this.id);const g=Object.assign({},this.opts,{query:f,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[o]);return new ct[o](g)}open(){let o;if(this.opts.rememberUpgrade&&c.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))o="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);o=this.transports[0]}this.readyState="opening";try{o=this.createTransport(o)}catch{return this.transports.shift(),void this.open()}o.open(),this.setTransport(o)}setTransport(o){this.transport&&this.transport.removeAllListeners(),this.transport=o,o.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",f=>this.onClose("transport close",f))}probe(o){let f=this.createTransport(o),g=!1;c.priorWebsocketSuccess=!1;const T=()=>{g||(f.send([{type:"ping",data:"probe"}]),f.once("packet",ae=>{if(!g)if("pong"===ae.type&&"probe"===ae.data){if(this.upgrading=!0,this.emitReserved("upgrading",f),!f)return;c.priorWebsocketSuccess="websocket"===f.name,this.transport.pause(()=>{g||"closed"!==this.readyState&&(dt(),this.setTransport(f),f.send([{type:"upgrade"}]),this.emitReserved("upgrade",f),f=null,this.upgrading=!1,this.flush())})}else{const Pe=new Error("probe error");Pe.transport=f.name,this.emitReserved("upgradeError",Pe)}}))};function M(){g||(g=!0,dt(),f.close(),f=null)}const q=ae=>{const Pe=new Error("probe error: "+ae);Pe.transport=f.name,M(),this.emitReserved("upgradeError",Pe)};function K(){q("transport closed")}function N(){q("socket closed")}function ve(ae){f&&ae.name!==f.name&&M()}const dt=()=>{f.removeListener("open",T),f.removeListener("error",q),f.removeListener("close",K),this.off("close",N),this.off("upgrading",ve)};f.once("open",T),f.once("error",q),f.once("close",K),this.once("close",N),this.once("upgrading",ve),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==o?this.setTimeoutFn(()=>{g||f.open()},200):f.open()}onOpen(){if(this.readyState="open",c.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){let o=0;const f=this.upgrades.length;for(;o<f;o++)this.probe(this.upgrades[o])}}onPacket(o){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",o),this.emitReserved("heartbeat"),this.resetPingTimeout(),o.type){case"open":this.onHandshake(JSON.parse(o.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const f=new Error("server error");f.code=o.data,this.onError(f);break;case"message":this.emitReserved("data",o.data),this.emitReserved("message",o.data)}}onHandshake(o){this.emitReserved("handshake",o),this.id=o.sid,this.transport.query.sid=o.sid,this.upgrades=this.filterUpgrades(o.upgrades),this.pingInterval=o.pingInterval,this.pingTimeout=o.pingTimeout,this.maxPayload=o.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const o=this.getWritablePackets();this.transport.send(o),this.prevBufferLen=o.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let f=1;for(let g=0;g<this.writeBuffer.length;g++){const T=this.writeBuffer[g].data;if(T&&(f+=vt(T)),g>0&&f>this.maxPayload)return this.writeBuffer.slice(0,g);f+=2}return this.writeBuffer}write(o,f,g){return this.sendPacket("message",o,f,g),this}send(o,f,g){return this.sendPacket("message",o,f,g),this}sendPacket(o,f,g,T){if("function"==typeof f&&(T=f,f=void 0),"function"==typeof g&&(T=g,g=null),"closing"===this.readyState||"closed"===this.readyState)return;(g=g||{}).compress=!1!==g.compress;const M={type:o,data:f,options:g};this.emitReserved("packetCreate",M),this.writeBuffer.push(M),T&&this.once("flush",T),this.flush()}close(){const o=()=>{this.onClose("forced close"),this.transport.close()},f=()=>{this.off("upgrade",f),this.off("upgradeError",f),o()},g=()=>{this.once("upgrade",f),this.once("upgradeError",f)};return("opening"===this.readyState||"open"===this.readyState)&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?g():o()}):this.upgrading?g():o()),this}onError(o){c.priorWebsocketSuccess=!1,this.emitReserved("error",o),this.onClose("transport error",o)}onClose(o,f){("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",o,f),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(o){const f=[];let g=0;const T=o.length;for(;g<T;g++)~this.transports.indexOf(o[g])&&f.push(o[g]);return f}}return c.protocol=4,c})();const Mt="function"==typeof ArrayBuffer,I=c=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(c):c.buffer instanceof ArrayBuffer,Ce=Object.prototype.toString,C="function"==typeof Blob||typeof Blob<"u"&&"[object BlobConstructor]"===Ce.call(Blob),tn="function"==typeof File||typeof File<"u"&&"[object FileConstructor]"===Ce.call(File);function Ye(c){return Mt&&(c instanceof ArrayBuffer||I(c))||C&&c instanceof Blob||tn&&c instanceof File}function ht(c,s){if(!c||"object"!=typeof c)return!1;if(Array.isArray(c)){for(let o=0,f=c.length;o<f;o++)if(ht(c[o]))return!0;return!1}if(Ye(c))return!0;if(c.toJSON&&"function"==typeof c.toJSON&&1===arguments.length)return ht(c.toJSON(),!0);for(const o in c)if(Object.prototype.hasOwnProperty.call(c,o)&&ht(c[o]))return!0;return!1}function Ir(c){const s=[],f=c;return f.data=Bt(c.data,s),f.attachments=s.length,{packet:f,buffers:s}}function Bt(c,s){if(!c)return c;if(Ye(c)){const o={_placeholder:!0,num:s.length};return s.push(c),o}if(Array.isArray(c)){const o=new Array(c.length);for(let f=0;f<c.length;f++)o[f]=Bt(c[f],s);return o}if("object"==typeof c&&!(c instanceof Date)){const o={};for(const f in c)Object.prototype.hasOwnProperty.call(c,f)&&(o[f]=Bt(c[f],s));return o}return c}function cr(c,s){return c.data=fr(c.data,s),delete c.attachments,c}function fr(c,s){if(!c)return c;if(c&&!0===c._placeholder){if("number"==typeof c.num&&c.num>=0&&c.num<s.length)return s[c.num];throw new Error("illegal attachments")}if(Array.isArray(c))for(let o=0;o<c.length;o++)c[o]=fr(c[o],s);else if("object"==typeof c)for(const o in c)Object.prototype.hasOwnProperty.call(c,o)&&(c[o]=fr(c[o],s));return c}const lr=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Ne=5;var F=function(c){return c[c.CONNECT=0]="CONNECT",c[c.DISCONNECT=1]="DISCONNECT",c[c.EVENT=2]="EVENT",c[c.ACK=3]="ACK",c[c.CONNECT_ERROR=4]="CONNECT_ERROR",c[c.BINARY_EVENT=5]="BINARY_EVENT",c[c.BINARY_ACK=6]="BINARY_ACK",c}(F||{});class Xe{constructor(s){this.replacer=s}encode(s){return s.type!==F.EVENT&&s.type!==F.ACK||!ht(s)?[this.encodeAsString(s)]:this.encodeAsBinary({type:s.type===F.EVENT?F.BINARY_EVENT:F.BINARY_ACK,nsp:s.nsp,data:s.data,id:s.id})}encodeAsString(s){let o=""+s.type;return(s.type===F.BINARY_EVENT||s.type===F.BINARY_ACK)&&(o+=s.attachments+"-"),s.nsp&&"/"!==s.nsp&&(o+=s.nsp+","),null!=s.id&&(o+=s.id),null!=s.data&&(o+=JSON.stringify(s.data,this.replacer)),o}encodeAsBinary(s){const o=Ir(s),f=this.encodeAsString(o.packet),g=o.buffers;return g.unshift(f),g}}function G(c){return"[object Object]"===Object.prototype.toString.call(c)}class X extends re{constructor(s){super(),this.reviver=s}add(s){let o;if("string"==typeof s){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");o=this.decodeString(s);const f=o.type===F.BINARY_EVENT;f||o.type===F.BINARY_ACK?(o.type=f?F.EVENT:F.ACK,this.reconstructor=new je(o),0===o.attachments&&super.emitReserved("decoded",o)):super.emitReserved("decoded",o)}else{if(!Ye(s)&&!s.base64)throw new Error("Unknown type: "+s);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");o=this.reconstructor.takeBinaryData(s),o&&(this.reconstructor=null,super.emitReserved("decoded",o))}}decodeString(s){let o=0;const f={type:Number(s.charAt(0))};if(void 0===F[f.type])throw new Error("unknown packet type "+f.type);if(f.type===F.BINARY_EVENT||f.type===F.BINARY_ACK){const T=o+1;for(;"-"!==s.charAt(++o)&&o!=s.length;);const M=s.substring(T,o);if(M!=Number(M)||"-"!==s.charAt(o))throw new Error("Illegal attachments");f.attachments=Number(M)}if("/"===s.charAt(o+1)){const T=o+1;for(;++o&&","!==s.charAt(o)&&o!==s.length;);f.nsp=s.substring(T,o)}else f.nsp="/";const g=s.charAt(o+1);if(""!==g&&Number(g)==g){const T=o+1;for(;++o;){const M=s.charAt(o);if(null==M||Number(M)!=M){--o;break}if(o===s.length)break}f.id=Number(s.substring(T,o+1))}if(s.charAt(++o)){const T=this.tryParse(s.substr(o));if(!X.isPayloadValid(f.type,T))throw new Error("invalid payload");f.data=T}return f}tryParse(s){try{return JSON.parse(s,this.reviver)}catch{return!1}}static isPayloadValid(s,o){switch(s){case F.CONNECT:return G(o);case F.DISCONNECT:return void 0===o;case F.CONNECT_ERROR:return"string"==typeof o||G(o);case F.EVENT:case F.BINARY_EVENT:return Array.isArray(o)&&("number"==typeof o[0]||"string"==typeof o[0]&&-1===lr.indexOf(o[0]));case F.ACK:case F.BINARY_ACK:return Array.isArray(o)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class je{constructor(s){this.packet=s,this.buffers=[],this.reconPack=s}takeBinaryData(s){if(this.buffers.push(s),this.buffers.length===this.reconPack.attachments){const o=cr(this.reconPack,this.buffers);return this.finishedReconstruction(),o}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function se(c,s,o){return c.on(s,o),function(){c.off(s,o)}}const Te=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class te extends re{constructor(s,o,f){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=s,this.nsp=o,f&&f.auth&&(this.auth=f.auth),this._opts=Object.assign({},f),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const s=this.io;this.subs=[se(s,"open",this.onopen.bind(this)),se(s,"packet",this.onpacket.bind(this)),se(s,"error",this.onerror.bind(this)),se(s,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...s){return s.unshift("message"),this.emit.apply(this,s),this}emit(s,...o){if(Te.hasOwnProperty(s))throw new Error('"'+s.toString()+'" is a reserved event name');if(o.unshift(s),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(o),this;const f={type:F.EVENT,data:o,options:{}};if(f.options.compress=!1!==this.flags.compress,"function"==typeof o[o.length-1]){const M=this.ids++,q=o.pop();this._registerAckCallback(M,q),f.id=M}return this.flags.volatile&&(!(this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable)||!this.connected)||(this.connected?(this.notifyOutgoingListeners(f),this.packet(f)):this.sendBuffer.push(f)),this.flags={},this}_registerAckCallback(s,o){var f;const g=null!==(f=this.flags.timeout)&&void 0!==f?f:this._opts.ackTimeout;if(void 0===g)return void(this.acks[s]=o);const T=this.io.setTimeoutFn(()=>{delete this.acks[s];for(let M=0;M<this.sendBuffer.length;M++)this.sendBuffer[M].id===s&&this.sendBuffer.splice(M,1);o.call(this,new Error("operation has timed out"))},g);this.acks[s]=(...M)=>{this.io.clearTimeoutFn(T),o.apply(this,[null,...M])}}emitWithAck(s,...o){const f=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise((g,T)=>{o.push((M,q)=>f?M?T(M):g(q):g(M)),this.emit(s,...o)})}_addToQueue(s){let o;"function"==typeof s[s.length-1]&&(o=s.pop());const f={id:this._queueSeq++,tryCount:0,pending:!1,args:s,flags:Object.assign({fromQueue:!0},this.flags)};s.push((g,...T)=>f!==this._queue[0]?void 0:(null!==g?f.tryCount>this._opts.retries&&(this._queue.shift(),o&&o(g)):(this._queue.shift(),o&&o(null,...T)),f.pending=!1,this._drainQueue())),this._queue.push(f),this._drainQueue()}_drainQueue(s=!1){if(!this.connected||0===this._queue.length)return;const o=this._queue[0];o.pending&&!s||(o.pending=!0,o.tryCount++,this.flags=o.flags,this.emit.apply(this,o.args))}packet(s){s.nsp=this.nsp,this.io._packet(s)}onopen(){"function"==typeof this.auth?this.auth(s=>{this._sendConnectPacket(s)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(s){this.packet({type:F.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},s):s})}onerror(s){this.connected||this.emitReserved("connect_error",s)}onclose(s,o){this.connected=!1,delete this.id,this.emitReserved("disconnect",s,o)}onpacket(s){if(s.nsp===this.nsp)switch(s.type){case F.CONNECT:s.data&&s.data.sid?this.onconnect(s.data.sid,s.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case F.EVENT:case F.BINARY_EVENT:this.onevent(s);break;case F.ACK:case F.BINARY_ACK:this.onack(s);break;case F.DISCONNECT:this.ondisconnect();break;case F.CONNECT_ERROR:this.destroy();const f=new Error(s.data.message);f.data=s.data.data,this.emitReserved("connect_error",f)}}onevent(s){const o=s.data||[];null!=s.id&&o.push(this.ack(s.id)),this.connected?this.emitEvent(o):this.receiveBuffer.push(Object.freeze(o))}emitEvent(s){if(this._anyListeners&&this._anyListeners.length){const o=this._anyListeners.slice();for(const f of o)f.apply(this,s)}super.emit.apply(this,s),this._pid&&s.length&&"string"==typeof s[s.length-1]&&(this._lastOffset=s[s.length-1])}ack(s){const o=this;let f=!1;return function(...g){f||(f=!0,o.packet({type:F.ACK,id:s,data:g}))}}onack(s){const o=this.acks[s.id];"function"==typeof o&&(o.apply(this,s.data),delete this.acks[s.id])}onconnect(s,o){this.id=s,this.recovered=o&&this._pid===o,this._pid=o,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(s=>this.emitEvent(s)),this.receiveBuffer=[],this.sendBuffer.forEach(s=>{this.notifyOutgoingListeners(s),this.packet(s)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(s=>s()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:F.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(s){return this.flags.compress=s,this}get volatile(){return this.flags.volatile=!0,this}timeout(s){return this.flags.timeout=s,this}onAny(s){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(s),this}prependAny(s){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(s),this}offAny(s){if(!this._anyListeners)return this;if(s){const o=this._anyListeners;for(let f=0;f<o.length;f++)if(s===o[f])return o.splice(f,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(s){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(s),this}prependAnyOutgoing(s){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(s),this}offAnyOutgoing(s){if(!this._anyOutgoingListeners)return this;if(s){const o=this._anyOutgoingListeners;for(let f=0;f<o.length;f++)if(s===o[f])return o.splice(f,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(s){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const o=this._anyOutgoingListeners.slice();for(const f of o)f.apply(this,s.data)}}}function fe(c){this.ms=(c=c||{}).min||100,this.max=c.max||1e4,this.factor=c.factor||2,this.jitter=c.jitter>0&&c.jitter<=1?c.jitter:0,this.attempts=0}fe.prototype.duration=function(){var c=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var s=Math.random(),o=Math.floor(s*this.jitter*c);c=1&Math.floor(10*s)?c+o:c-o}return 0|Math.min(c,this.max)},fe.prototype.reset=function(){this.attempts=0},fe.prototype.setMin=function(c){this.ms=c},fe.prototype.setMax=function(c){this.max=c},fe.prototype.setJitter=function(c){this.jitter=c};class Y extends re{constructor(s,o){var f;super(),this.nsps={},this.subs=[],s&&"object"==typeof s&&(o=s,s=void 0),(o=o||{}).path=o.path||"/socket.io",this.opts=o,Ge(this,o),this.reconnection(!1!==o.reconnection),this.reconnectionAttempts(o.reconnectionAttempts||1/0),this.reconnectionDelay(o.reconnectionDelay||1e3),this.reconnectionDelayMax(o.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(f=o.randomizationFactor)&&void 0!==f?f:.5),this.backoff=new fe({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==o.timeout?2e4:o.timeout),this._readyState="closed",this.uri=s;const g=o.parser||y;this.encoder=new g.Encoder,this.decoder=new g.Decoder,this._autoConnect=!1!==o.autoConnect,this._autoConnect&&this.open()}reconnection(s){return arguments.length?(this._reconnection=!!s,this):this._reconnection}reconnectionAttempts(s){return void 0===s?this._reconnectionAttempts:(this._reconnectionAttempts=s,this)}reconnectionDelay(s){var o;return void 0===s?this._reconnectionDelay:(this._reconnectionDelay=s,null===(o=this.backoff)||void 0===o||o.setMin(s),this)}randomizationFactor(s){var o;return void 0===s?this._randomizationFactor:(this._randomizationFactor=s,null===(o=this.backoff)||void 0===o||o.setJitter(s),this)}reconnectionDelayMax(s){var o;return void 0===s?this._reconnectionDelayMax:(this._reconnectionDelayMax=s,null===(o=this.backoff)||void 0===o||o.setMax(s),this)}timeout(s){return arguments.length?(this._timeout=s,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(s){if(~this._readyState.indexOf("open"))return this;this.engine=new ar(this.uri,this.opts);const o=this.engine,f=this;this._readyState="opening",this.skipReconnect=!1;const g=se(o,"open",function(){f.onopen(),s&&s()}),T=q=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",q),s?s(q):this.maybeReconnectOnOpen()},M=se(o,"error",T);if(!1!==this._timeout){const K=this.setTimeoutFn(()=>{g(),T(new Error("timeout")),o.close()},this._timeout);this.opts.autoUnref&&K.unref(),this.subs.push(()=>{this.clearTimeoutFn(K)})}return this.subs.push(g),this.subs.push(M),this}connect(s){return this.open(s)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const s=this.engine;this.subs.push(se(s,"ping",this.onping.bind(this)),se(s,"data",this.ondata.bind(this)),se(s,"error",this.onerror.bind(this)),se(s,"close",this.onclose.bind(this)),se(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(s){try{this.decoder.add(s)}catch(o){this.onclose("parse error",o)}}ondecoded(s){Ie(()=>{this.emitReserved("packet",s)},this.setTimeoutFn)}onerror(s){this.emitReserved("error",s)}socket(s,o){let f=this.nsps[s];return f?this._autoConnect&&!f.active&&f.connect():(f=new te(this,s,o),this.nsps[s]=f),f}_destroy(s){const o=Object.keys(this.nsps);for(const f of o)if(this.nsps[f].active)return;this._close()}_packet(s){const o=this.encoder.encode(s);for(let f=0;f<o.length;f++)this.engine.write(o[f],s.options)}cleanup(){this.subs.forEach(s=>s()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(s,o){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",s,o),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const s=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const o=this.backoff.duration();this._reconnecting=!0;const f=this.setTimeoutFn(()=>{s.skipReconnect||(this.emitReserved("reconnect_attempt",s.backoff.attempts),!s.skipReconnect&&s.open(g=>{g?(s._reconnecting=!1,s.reconnect(),this.emitReserved("reconnect_error",g)):s.onreconnect()}))},o);this.opts.autoUnref&&f.unref(),this.subs.push(()=>{this.clearTimeoutFn(f)})}}onreconnect(){const s=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",s)}}const we={};function oe(c,s){"object"==typeof c&&(s=c,c=void 0);const o=function ut(c,s="",o){let f=c;o=o||typeof location<"u"&&location,null==c&&(c=o.protocol+"//"+o.host),"string"==typeof c&&("/"===c.charAt(0)&&(c="/"===c.charAt(1)?o.protocol+c:o.host+c),/^(https?|wss?):\/\//.test(c)||(c=typeof o<"u"?o.protocol+"//"+c:"https://"+c),f=sr(c)),f.port||(/^(http|ws)$/.test(f.protocol)?f.port="80":/^(http|ws)s$/.test(f.protocol)&&(f.port="443")),f.path=f.path||"/";const T=-1!==f.host.indexOf(":")?"["+f.host+"]":f.host;return f.id=f.protocol+"://"+T+":"+f.port+s,f.href=f.protocol+"://"+T+(o&&o.port===f.port?"":":"+f.port),f}(c,(s=s||{}).path||"/socket.io"),f=o.source,g=o.id;let K;return s.forceNew||s["force new connection"]||!1===s.multiplex||we[g]&&o.path in we[g].nsps?K=new Y(f,s):(we[g]||(we[g]=new Y(f,s)),K=we[g]),o.query&&!s.query&&(s.query=o.queryKey),K.socket(o.path,s)}Object.assign(oe,{Manager:Y,Socket:te,io:oe,connect:oe})}}]);